<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>七.shell | devops学习笔记</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="个人总结的vuepress学习技术文档-语法">
    <meta name="keywords" content="vuepress,最新技术文档,vuepress语法,markdown语法">
    
    <link rel="preload" href="/web-devops/assets/css/0.styles.497ce520.css" as="style"><link rel="preload" href="/web-devops/assets/js/app.fb86f629.js" as="script"><link rel="preload" href="/web-devops/assets/js/2.164ecb15.js" as="script"><link rel="preload" href="/web-devops/assets/js/58.8e62c021.js" as="script"><link rel="preload" href="/web-devops/assets/js/3.c618d7cd.js" as="script"><link rel="prefetch" href="/web-devops/assets/js/10.c4c80143.js"><link rel="prefetch" href="/web-devops/assets/js/100.971ed007.js"><link rel="prefetch" href="/web-devops/assets/js/101.61e27331.js"><link rel="prefetch" href="/web-devops/assets/js/102.66da9196.js"><link rel="prefetch" href="/web-devops/assets/js/103.c3eee109.js"><link rel="prefetch" href="/web-devops/assets/js/104.3d0f69f6.js"><link rel="prefetch" href="/web-devops/assets/js/105.0d501cf2.js"><link rel="prefetch" href="/web-devops/assets/js/106.289fbdc8.js"><link rel="prefetch" href="/web-devops/assets/js/107.d8775c39.js"><link rel="prefetch" href="/web-devops/assets/js/108.251a2319.js"><link rel="prefetch" href="/web-devops/assets/js/109.3e9095ac.js"><link rel="prefetch" href="/web-devops/assets/js/11.bbbc7fa2.js"><link rel="prefetch" href="/web-devops/assets/js/110.726c1346.js"><link rel="prefetch" href="/web-devops/assets/js/111.cb48bda0.js"><link rel="prefetch" href="/web-devops/assets/js/112.a6d51433.js"><link rel="prefetch" href="/web-devops/assets/js/113.4cb87d7a.js"><link rel="prefetch" href="/web-devops/assets/js/114.4329a537.js"><link rel="prefetch" href="/web-devops/assets/js/115.14d5186e.js"><link rel="prefetch" href="/web-devops/assets/js/116.3ad9882d.js"><link rel="prefetch" href="/web-devops/assets/js/117.1815e873.js"><link rel="prefetch" href="/web-devops/assets/js/118.ab788b4b.js"><link rel="prefetch" href="/web-devops/assets/js/119.ca5e0557.js"><link rel="prefetch" href="/web-devops/assets/js/12.9f27a44c.js"><link rel="prefetch" href="/web-devops/assets/js/120.9ad98a30.js"><link rel="prefetch" href="/web-devops/assets/js/121.0222e236.js"><link rel="prefetch" href="/web-devops/assets/js/122.59e3ae67.js"><link rel="prefetch" href="/web-devops/assets/js/123.6827b045.js"><link rel="prefetch" href="/web-devops/assets/js/124.987b1efe.js"><link rel="prefetch" href="/web-devops/assets/js/125.2af5f8ab.js"><link rel="prefetch" href="/web-devops/assets/js/126.16d8279d.js"><link rel="prefetch" href="/web-devops/assets/js/127.b092097a.js"><link rel="prefetch" href="/web-devops/assets/js/128.c654bff5.js"><link rel="prefetch" href="/web-devops/assets/js/129.e06f2bfa.js"><link rel="prefetch" href="/web-devops/assets/js/13.19d5ef21.js"><link rel="prefetch" href="/web-devops/assets/js/130.dccb7863.js"><link rel="prefetch" href="/web-devops/assets/js/131.cfb5f8bf.js"><link rel="prefetch" href="/web-devops/assets/js/132.370a0868.js"><link rel="prefetch" href="/web-devops/assets/js/133.bea5a8f1.js"><link rel="prefetch" href="/web-devops/assets/js/134.e04d15e2.js"><link rel="prefetch" href="/web-devops/assets/js/135.a8d33806.js"><link rel="prefetch" href="/web-devops/assets/js/136.101051f1.js"><link rel="prefetch" href="/web-devops/assets/js/137.508813bb.js"><link rel="prefetch" href="/web-devops/assets/js/138.5c009c9d.js"><link rel="prefetch" href="/web-devops/assets/js/139.c5889da0.js"><link rel="prefetch" href="/web-devops/assets/js/14.78bdd85c.js"><link rel="prefetch" href="/web-devops/assets/js/140.38d640f3.js"><link rel="prefetch" href="/web-devops/assets/js/141.4616e237.js"><link rel="prefetch" href="/web-devops/assets/js/142.595ed7ba.js"><link rel="prefetch" href="/web-devops/assets/js/143.6bbf494a.js"><link rel="prefetch" href="/web-devops/assets/js/144.362daae3.js"><link rel="prefetch" href="/web-devops/assets/js/145.62cf49d0.js"><link rel="prefetch" href="/web-devops/assets/js/146.e32977eb.js"><link rel="prefetch" href="/web-devops/assets/js/147.27d65702.js"><link rel="prefetch" href="/web-devops/assets/js/148.d9eef206.js"><link rel="prefetch" href="/web-devops/assets/js/149.a70425a3.js"><link rel="prefetch" href="/web-devops/assets/js/15.42180d14.js"><link rel="prefetch" href="/web-devops/assets/js/150.f54124ed.js"><link rel="prefetch" href="/web-devops/assets/js/151.e17783d0.js"><link rel="prefetch" href="/web-devops/assets/js/152.412855b5.js"><link rel="prefetch" href="/web-devops/assets/js/153.b6f038b7.js"><link rel="prefetch" href="/web-devops/assets/js/154.8062c865.js"><link rel="prefetch" href="/web-devops/assets/js/155.8e966346.js"><link rel="prefetch" href="/web-devops/assets/js/156.454d09f3.js"><link rel="prefetch" href="/web-devops/assets/js/157.518cd7eb.js"><link rel="prefetch" href="/web-devops/assets/js/158.203857c4.js"><link rel="prefetch" href="/web-devops/assets/js/159.d4ececca.js"><link rel="prefetch" href="/web-devops/assets/js/16.a8f52095.js"><link rel="prefetch" href="/web-devops/assets/js/160.12ce3e26.js"><link rel="prefetch" href="/web-devops/assets/js/161.0254f52d.js"><link rel="prefetch" href="/web-devops/assets/js/162.b2715625.js"><link rel="prefetch" href="/web-devops/assets/js/163.bb5487a5.js"><link rel="prefetch" href="/web-devops/assets/js/164.512725e1.js"><link rel="prefetch" href="/web-devops/assets/js/165.bcf7bfe4.js"><link rel="prefetch" href="/web-devops/assets/js/166.4cf8115e.js"><link rel="prefetch" href="/web-devops/assets/js/167.3b3b7240.js"><link rel="prefetch" href="/web-devops/assets/js/168.97a79262.js"><link rel="prefetch" href="/web-devops/assets/js/169.da16eb56.js"><link rel="prefetch" href="/web-devops/assets/js/17.dce2a012.js"><link rel="prefetch" href="/web-devops/assets/js/170.2c7231a2.js"><link rel="prefetch" href="/web-devops/assets/js/171.f9c9213a.js"><link rel="prefetch" href="/web-devops/assets/js/172.9fdafb21.js"><link rel="prefetch" href="/web-devops/assets/js/173.f0267b71.js"><link rel="prefetch" href="/web-devops/assets/js/174.f84fad41.js"><link rel="prefetch" href="/web-devops/assets/js/175.df40cae9.js"><link rel="prefetch" href="/web-devops/assets/js/176.f86f8a1f.js"><link rel="prefetch" href="/web-devops/assets/js/177.f17b36f2.js"><link rel="prefetch" href="/web-devops/assets/js/178.1d65713e.js"><link rel="prefetch" href="/web-devops/assets/js/179.d55d6174.js"><link rel="prefetch" href="/web-devops/assets/js/18.95449eee.js"><link rel="prefetch" href="/web-devops/assets/js/19.63486875.js"><link rel="prefetch" href="/web-devops/assets/js/20.e3373c58.js"><link rel="prefetch" href="/web-devops/assets/js/21.8b5599d2.js"><link rel="prefetch" href="/web-devops/assets/js/22.2ec797ae.js"><link rel="prefetch" href="/web-devops/assets/js/23.08cb57eb.js"><link rel="prefetch" href="/web-devops/assets/js/24.dc63fd2d.js"><link rel="prefetch" href="/web-devops/assets/js/25.38c4f1a2.js"><link rel="prefetch" href="/web-devops/assets/js/26.0ed58636.js"><link rel="prefetch" href="/web-devops/assets/js/27.bbf8a0c7.js"><link rel="prefetch" href="/web-devops/assets/js/28.f5c58c92.js"><link rel="prefetch" href="/web-devops/assets/js/29.074e3c94.js"><link rel="prefetch" href="/web-devops/assets/js/30.4acf5f3e.js"><link rel="prefetch" href="/web-devops/assets/js/31.f79691f2.js"><link rel="prefetch" href="/web-devops/assets/js/32.f6a079e3.js"><link rel="prefetch" href="/web-devops/assets/js/33.e0a641f9.js"><link rel="prefetch" href="/web-devops/assets/js/34.dcb0991b.js"><link rel="prefetch" href="/web-devops/assets/js/35.6a2e7a27.js"><link rel="prefetch" href="/web-devops/assets/js/36.1ad28368.js"><link rel="prefetch" href="/web-devops/assets/js/37.c803a078.js"><link rel="prefetch" href="/web-devops/assets/js/38.bd17bb9c.js"><link rel="prefetch" href="/web-devops/assets/js/39.d26892b0.js"><link rel="prefetch" href="/web-devops/assets/js/4.8cdb27be.js"><link rel="prefetch" href="/web-devops/assets/js/40.ce21a909.js"><link rel="prefetch" href="/web-devops/assets/js/41.a2f71d88.js"><link rel="prefetch" href="/web-devops/assets/js/42.f477d08a.js"><link rel="prefetch" href="/web-devops/assets/js/43.f8fac3b3.js"><link rel="prefetch" href="/web-devops/assets/js/44.e673a250.js"><link rel="prefetch" href="/web-devops/assets/js/45.effeca82.js"><link rel="prefetch" href="/web-devops/assets/js/46.9a49cc34.js"><link rel="prefetch" href="/web-devops/assets/js/47.770b8dbc.js"><link rel="prefetch" href="/web-devops/assets/js/48.583d3bbc.js"><link rel="prefetch" href="/web-devops/assets/js/49.047c0f7a.js"><link rel="prefetch" href="/web-devops/assets/js/5.545069d0.js"><link rel="prefetch" href="/web-devops/assets/js/50.f5825d0b.js"><link rel="prefetch" href="/web-devops/assets/js/51.7882d1ac.js"><link rel="prefetch" href="/web-devops/assets/js/52.4bde42f0.js"><link rel="prefetch" href="/web-devops/assets/js/53.2ad17a9d.js"><link rel="prefetch" href="/web-devops/assets/js/54.ee524af3.js"><link rel="prefetch" href="/web-devops/assets/js/55.518bc104.js"><link rel="prefetch" href="/web-devops/assets/js/56.efc67e91.js"><link rel="prefetch" href="/web-devops/assets/js/57.efb88768.js"><link rel="prefetch" href="/web-devops/assets/js/59.50b553cd.js"><link rel="prefetch" href="/web-devops/assets/js/6.de381195.js"><link rel="prefetch" href="/web-devops/assets/js/60.4f108a8c.js"><link rel="prefetch" href="/web-devops/assets/js/61.a157ceda.js"><link rel="prefetch" href="/web-devops/assets/js/62.165c9873.js"><link rel="prefetch" href="/web-devops/assets/js/63.12e59f2c.js"><link rel="prefetch" href="/web-devops/assets/js/64.37e7b68e.js"><link rel="prefetch" href="/web-devops/assets/js/65.f89309eb.js"><link rel="prefetch" href="/web-devops/assets/js/66.c0d7b1e4.js"><link rel="prefetch" href="/web-devops/assets/js/67.b6f00bb8.js"><link rel="prefetch" href="/web-devops/assets/js/68.c1d9f940.js"><link rel="prefetch" href="/web-devops/assets/js/69.0f5f4814.js"><link rel="prefetch" href="/web-devops/assets/js/7.ca6994d5.js"><link rel="prefetch" href="/web-devops/assets/js/70.3da2e620.js"><link rel="prefetch" href="/web-devops/assets/js/71.c4795120.js"><link rel="prefetch" href="/web-devops/assets/js/72.71678acc.js"><link rel="prefetch" href="/web-devops/assets/js/73.852e2151.js"><link rel="prefetch" href="/web-devops/assets/js/74.dbb2c8aa.js"><link rel="prefetch" href="/web-devops/assets/js/75.4a6e55b8.js"><link rel="prefetch" href="/web-devops/assets/js/76.b95d33f5.js"><link rel="prefetch" href="/web-devops/assets/js/77.311c3545.js"><link rel="prefetch" href="/web-devops/assets/js/78.91956c16.js"><link rel="prefetch" href="/web-devops/assets/js/79.3fc4ab11.js"><link rel="prefetch" href="/web-devops/assets/js/8.cf898ea5.js"><link rel="prefetch" href="/web-devops/assets/js/80.6795aa4e.js"><link rel="prefetch" href="/web-devops/assets/js/81.7ac12f3d.js"><link rel="prefetch" href="/web-devops/assets/js/82.00180639.js"><link rel="prefetch" href="/web-devops/assets/js/83.52009bfe.js"><link rel="prefetch" href="/web-devops/assets/js/84.70e6c0da.js"><link rel="prefetch" href="/web-devops/assets/js/85.2efa0446.js"><link rel="prefetch" href="/web-devops/assets/js/86.f27d7a94.js"><link rel="prefetch" href="/web-devops/assets/js/87.709f6495.js"><link rel="prefetch" href="/web-devops/assets/js/88.12016ee6.js"><link rel="prefetch" href="/web-devops/assets/js/89.581ddfc7.js"><link rel="prefetch" href="/web-devops/assets/js/9.3ab9fea4.js"><link rel="prefetch" href="/web-devops/assets/js/90.f89227e1.js"><link rel="prefetch" href="/web-devops/assets/js/91.44b9e88e.js"><link rel="prefetch" href="/web-devops/assets/js/92.118ef291.js"><link rel="prefetch" href="/web-devops/assets/js/93.82217a25.js"><link rel="prefetch" href="/web-devops/assets/js/94.0e8dcca2.js"><link rel="prefetch" href="/web-devops/assets/js/95.ed503336.js"><link rel="prefetch" href="/web-devops/assets/js/96.e66bfadb.js"><link rel="prefetch" href="/web-devops/assets/js/97.d0d1a1ef.js"><link rel="prefetch" href="/web-devops/assets/js/98.86f9c78a.js"><link rel="prefetch" href="/web-devops/assets/js/99.5cca477b.js">
    <link rel="stylesheet" href="/web-devops/assets/css/0.styles.497ce520.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/web-devops/" class="home-link router-link-active"><!----> <span class="site-name">devops学习笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础知识" class="dropdown-title"><span class="title">基础知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础知识" class="mobile-dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-devops/base/linux/1.index.html" class="nav-link">
  一.linux基础
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/base/auth/1.index.html" class="nav-link">
  二.cicd
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/base/system/1.index.html" class="nav-link">
  三.shell
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/base/service/1.index.html" class="nav-link">
  四.vim
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/base/network/1.index.html" class="nav-link">
  五.network
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="相关应用" class="dropdown-title"><span class="title">相关应用</span> <span class="arrow down"></span></button> <button type="button" aria-label="相关应用" class="mobile-dropdown-title"><span class="title">相关应用</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-devops/application/vi/1.index.html" class="nav-link">
  一.vim
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/application/user/1.index.html" class="nav-link">
  二.Kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/application/shell/1.index.html" class="nav-link">
  三.VMware
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/application/install/1.index.html" class="nav-link">
  四.Parallels
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高级知识" class="dropdown-title"><span class="title">高级知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="高级知识" class="mobile-dropdown-title"><span class="title">高级知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-devops/senior/nginx/1.index.html" class="nav-link">
  一.nginx
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/docker/1.index.html" class="nav-link">
  二.docker
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/jenkins/1.index.html" class="nav-link">
  三.jenkins
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/groovy/1.index.html" class="nav-link">
  四.groovy
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/php/1.index.html" class="nav-link">
  五.php
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/java/1.index.html" class="nav-link">
  六.java
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/node/1.index.html" class="nav-link">
  七.node
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/k8s/1.index.html" class="nav-link">
  八.k8s
</a></li></ul></div></div> <a href="https://github.com/zhoubichuan/web-devops" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="基础知识" class="dropdown-title"><span class="title">基础知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="基础知识" class="mobile-dropdown-title"><span class="title">基础知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-devops/base/linux/1.index.html" class="nav-link">
  一.linux基础
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/base/auth/1.index.html" class="nav-link">
  二.cicd
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/base/system/1.index.html" class="nav-link">
  三.shell
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/base/service/1.index.html" class="nav-link">
  四.vim
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/base/network/1.index.html" class="nav-link">
  五.network
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="相关应用" class="dropdown-title"><span class="title">相关应用</span> <span class="arrow down"></span></button> <button type="button" aria-label="相关应用" class="mobile-dropdown-title"><span class="title">相关应用</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-devops/application/vi/1.index.html" class="nav-link">
  一.vim
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/application/user/1.index.html" class="nav-link">
  二.Kubernetes
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/application/shell/1.index.html" class="nav-link">
  三.VMware
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/application/install/1.index.html" class="nav-link">
  四.Parallels
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="高级知识" class="dropdown-title"><span class="title">高级知识</span> <span class="arrow down"></span></button> <button type="button" aria-label="高级知识" class="mobile-dropdown-title"><span class="title">高级知识</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/web-devops/senior/nginx/1.index.html" class="nav-link">
  一.nginx
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/docker/1.index.html" class="nav-link">
  二.docker
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/jenkins/1.index.html" class="nav-link">
  三.jenkins
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/groovy/1.index.html" class="nav-link">
  四.groovy
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/php/1.index.html" class="nav-link">
  五.php
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/java/1.index.html" class="nav-link">
  六.java
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/node/1.index.html" class="nav-link">
  七.node
</a></li><li class="dropdown-item"><!----> <a href="/web-devops/senior/k8s/1.index.html" class="nav-link">
  八.k8s
</a></li></ul></div></div> <a href="https://github.com/zhoubichuan/web-devops" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/web-devops/base/linux/1.index.html" class="sidebar-link">Linux 基础</a></li><li><a href="/web-devops/base/linux/2.webpack.html" class="sidebar-link">一.配置服务器</a></li><li><a href="/web-devops/base/linux/3.file.html" class="sidebar-link">二.认识Linux</a></li><li><a href="/web-devops/base/linux/4.single.html" class="sidebar-link">三.linux 常用命令</a></li><li><a href="/web-devops/base/linux/5.page.html" class="sidebar-link">四.用户和用户组</a></li><li><a href="/web-devops/base/linux/7.module.html" class="sidebar-link">六.权限</a></li><li><a href="/web-devops/base/linux/8.project.html" aria-current="page" class="active sidebar-link">七.shell</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_1-shell-基础" class="sidebar-link">1.shell 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_1-1-查看支持的-shell" class="sidebar-link">1.1 查看支持的 shell</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_1-2-echo" class="sidebar-link">1.2 echo</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_1-3-编写执行-shell" class="sidebar-link">1.3 编写执行 shell</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_1-4-别名" class="sidebar-link">1.4 别名</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_1-5-命令的生效顺序" class="sidebar-link">1.5 命令的生效顺序</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_1-6-命令快捷键" class="sidebar-link">1.6 命令快捷键</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_1-7-历史命令" class="sidebar-link">1.7 历史命令</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_1-8-调用" class="sidebar-link">1.8 调用</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_1-9-输出重定向" class="sidebar-link">1.9 输出重定向</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_1-10-管道符号" class="sidebar-link">1.10 管道符号</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_2-变量" class="sidebar-link">2. 变量</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_2-1-什么是变量" class="sidebar-link">2.1 什么是变量</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_2-2-变量的分类" class="sidebar-link">2.2 变量的分类</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_2-3-用户自定义变量" class="sidebar-link">2.3 用户自定义变量</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_2-4-环境变量" class="sidebar-link">2.4 环境变量</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_2-5-位置参数变量" class="sidebar-link">2.5 位置参数变量</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_2-6-预定义变量" class="sidebar-link">2.6 预定义变量</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_2-7-read" class="sidebar-link">2.7 read</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_3-运算符" class="sidebar-link">3.运算符</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_3-1-declare-命令" class="sidebar-link">3.1 declare 命令</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_3-2-数值运算的方法" class="sidebar-link">3.2 数值运算的方法</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_3-2-2-优先级" class="sidebar-link">3.2.2 优先级</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-环境变量配置文件" class="sidebar-link">4. 环境变量配置文件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-1-source-命令" class="sidebar-link">4.1 source 命令</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-2-环境变量配置文件简介" class="sidebar-link">4.2 环境变量配置文件简介</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-3-环境变量配置文件的功能" class="sidebar-link">4.3 环境变量配置文件的功能</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-1-概念" class="sidebar-link">4.1 概念</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-2-通配符" class="sidebar-link">4.2 通配符</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-3-正则表达式" class="sidebar-link">4.3 正则表达式</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-4-元字符" class="sidebar-link">4.4 元字符</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-5-cut" class="sidebar-link">4.5 cut</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-6-printf" class="sidebar-link">4.6 printf</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-7-awk" class="sidebar-link">4.7 awk</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-7-2-fs" class="sidebar-link">4.7.2 FS</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-7-3-声明变量" class="sidebar-link">4.7.3 声明变量</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-7-4-多条件" class="sidebar-link">4.7.4 多条件</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-7-5-nr" class="sidebar-link">4.7.5 NR</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-7-6-ofs" class="sidebar-link">4.7.6 OFS</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-8-sed-命令" class="sidebar-link">4.8 sed 命令</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-9-排序命令-sort" class="sidebar-link">4.9 排序命令 sort</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_4-10-wc" class="sidebar-link">4.10 wc</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_5-流程控制" class="sidebar-link">5. 流程控制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_5-1-条件判断" class="sidebar-link">5.1 条件判断</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_5-2-单分支-if-语句" class="sidebar-link">5.2 单分支 if 语句</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_5-3-双分支-if-语句" class="sidebar-link">5.3 双分支 if 语句</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_5-4-多分支-if-语句" class="sidebar-link">5.4 多分支 if 语句</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_5-5-case-语句" class="sidebar-link">5.5 case 语句</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_5-6-for-循环" class="sidebar-link">5.6 for 循环</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_5-7-while-循环" class="sidebar-link">5.7 while 循环</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_5-8-until-循环" class="sidebar-link">5.8 until 循环</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_6-函数" class="sidebar-link">6. 函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_6-1-简单函数" class="sidebar-link">6.1 简单函数</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_6-2-返回值" class="sidebar-link">6.2 返回值</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_6-3-参数说明" class="sidebar-link">6.3 参数说明</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_6-4-profile" class="sidebar-link">6.4 profile</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-shell-实战" class="sidebar-link">7.shell 实战</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-1-注意事项" class="sidebar-link">7.1 注意事项</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-2-获取随机字符串或数字" class="sidebar-link">7.2 获取随机字符串或数字</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-3-定义一个颜色输出字符串函数" class="sidebar-link">7.3 定义一个颜色输出字符串函数</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-4-批量创建用户" class="sidebar-link">7.4 批量创建用户</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-5-检查主机存活状态" class="sidebar-link">7.5 检查主机存活状态</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-6-系统监控" class="sidebar-link">7.6 系统监控</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-6-2-函数" class="sidebar-link">7.6.2 函数</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-7-监控网络流量" class="sidebar-link">7.7 监控网络流量</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-8-监控网站状态" class="sidebar-link">7.8 监控网站状态</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-9-监控-nginx-状态" class="sidebar-link">7.9 监控 nginx 状态</a></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_7-10-监控-mysql-状态" class="sidebar-link">7.10 监控 mysql 状态</a></li></ul></li><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_8-附录" class="sidebar-link">8. 附录</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/web-devops/base/linux/8.project.html#_8-1-linux-特殊文件" class="sidebar-link">8.1. Linux 特殊文件</a></li></ul></li></ul></li><li><a href="/web-devops/base/linux/9.utils.html" class="sidebar-link">八.软件包管理</a></li><li><a href="/web-devops/base/linux/10.ui.html" class="sidebar-link">九.进程管理</a></li><li><a href="/web-devops/base/linux/11.data.html" class="sidebar-link">十.服务</a></li><li><a href="/web-devops/base/linux/12.skill.html" class="sidebar-link">十一.网络</a></li><li><a href="/web-devops/base/linux/13.com.html" class="sidebar-link">十二.内核</a></li><li><a href="/web-devops/base/linux/14.data.html" class="sidebar-link">十三.文件系统</a></li><li><a href="/web-devops/base/linux/15.api.html" class="sidebar-link">十四.应用程序</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="七-shell"><a href="#七-shell" class="header-anchor">#</a> 七.shell</h1> <h2 id="_1-shell-基础"><a href="#_1-shell-基础" class="header-anchor">#</a> 1.shell 基础</h2> <ul><li>shell 是一个命令行解释器，它为用户提供了一个向 Linux 内核发送请求以便运行程序的界面系统级程序</li> <li>用户可以用 Shell 来启动、挂起、停止或者编写一些程序</li> <li>Shell 还是一个功能相当强大的编程语言，易编写，易调试，灵活性较强。</li> <li>Shell 是解释执行的脚本语言，在 Shell 中可以直接调用 Linux 系统命令。</li></ul> <h3 id="_1-1-查看支持的-shell"><a href="#_1-1-查看支持的-shell" class="header-anchor">#</a> 1.1 查看支持的 shell</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">cat</span> /etc/shells
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查看 shell 的帮助信息</p> <table><thead><tr><th>命令</th> <th>作用</th></tr></thead> <tbody><tr><td>man bash</td> <td>查看 bash 的命令帮助</td></tr> <tr><td>info bash</td> <td>查看 bash 的文档</td></tr> <tr><td>help</td> <td>命令显示 bash 支持的命令</td></tr> <tr><td>help cd</td> <td>如果想看某个命令的帮助可以 help 命令</td></tr></tbody></table> <h3 id="_1-2-echo"><a href="#_1-2-echo" class="header-anchor">#</a> 1.2 echo</h3> <ul><li>输出命令</li> <li>--e 支持反斜线控制的字符转换
<table><thead><tr><th>控制字符</th> <th>作用</th></tr></thead> <tbody><tr><td>\n</td> <td>换行符</td></tr> <tr><td>\r</td> <td>回车键</td></tr> <tr><td>\t</td> <td>制表符，也就是 Tab 键</td></tr> <tr><td>\v</td> <td>垂直制表符</td></tr> <tr><td>\onnn</td> <td>按照八进制 ASCII 码表输出字符，其中 0 为数字零，nnn 是三位八进制数</td></tr> <tr><td>\xhh</td> <td>按照十六进制 ASCII 码表输出字符，其中 hh 是两位十六进制数</td></tr></tbody></table></li></ul> <table><thead><tr><th>符号</th> <th>颜色</th></tr></thead> <tbody><tr><td>#30m</td> <td>黑色</td></tr> <tr><td>#31</td> <td>红色</td></tr> <tr><td>#32</td> <td>绿色</td></tr> <tr><td>#33</td> <td>黄色</td></tr> <tr><td>#34</td> <td>蓝色</td></tr> <tr><td>#35</td> <td>洋红</td></tr> <tr><td>#36</td> <td>青涩</td></tr> <tr><td>#37</td> <td>白色</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> -e <span class="token string">&quot;12<span class="token entity" title="\r">\r</span><span class="token entity" title="\n">\n</span>34<span class="token entity" title="\t">\t</span>56<span class="token entity" title="\v">\v</span>78&quot;</span>
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\014">\014</span>1&quot;</span>
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\x61">\x61</span>&quot;</span>
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\e">\e</span>[1;31m warning <span class="token entity" title="\e">\e</span>[0m&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_1-3-编写执行-shell"><a href="#_1-3-编写执行-shell" class="header-anchor">#</a> 1.3 编写执行 shell</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\e">\e</span>[1;34m hello world <span class="token entity" title="\e">\e</span>[0m&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>赋予执行权限，直接运行</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">chmod</span> <span class="token number">755</span> hello.sh
./hello.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>通过 Bash 调用执行脚本</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">bash</span> hello.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_1-4-别名"><a href="#_1-4-别名" class="header-anchor">#</a> 1.4 别名</h3> <ul><li>命令别名 == 小名</li> <li>临时生效</li> <li>alias</li> <li>alias rm=&quot;rm -i&quot;</li> <li>写入环境变量配置文件 vi ~/.bashrc</li> <li>source ~/.bashrc</li> <li>unalias 别名 删除别名</li></ul> <h3 id="_1-5-命令的生效顺序"><a href="#_1-5-命令的生效顺序" class="header-anchor">#</a> 1.5 命令的生效顺序</h3> <ul><li>绝对路径或者相对路径</li> <li>别名</li> <li>bash 内部命令</li> <li>按照$PATH 环境变量定义的目录查找顺序找到的第一个命令</li></ul> <h3 id="_1-6-命令快捷键"><a href="#_1-6-命令快捷键" class="header-anchor">#</a> 1.6 命令快捷键</h3> <table><thead><tr><th>命令</th> <th>含义</th></tr></thead> <tbody><tr><td>ctrl+c</td> <td>强制终止当前命令</td></tr> <tr><td>ctrl+l</td> <td>清屏</td></tr> <tr><td>ctrl+a</td> <td>光标移动到命令行首</td></tr> <tr><td>ctrl+e</td> <td>光标移动到命令行尾</td></tr> <tr><td>ctrl+u</td> <td>从光标所在的位置删除到行首</td></tr> <tr><td>ctrl+z</td> <td>把命令放入后台</td></tr> <tr><td>fg</td> <td>把任务带回前台</td></tr> <tr><td>ctrl+r</td> <td>在历史命令中搜索</td></tr></tbody></table> <h3 id="_1-7-历史命令"><a href="#_1-7-历史命令" class="header-anchor">#</a> 1.7 历史命令</h3> <ul><li>history [选项] [历史命令保存文件]</li> <li>选项
<ul><li>-c 清空历史命令</li> <li>-w 把缓存中的历史命令写入历史命令保存文件 ~/.bash_history</li></ul></li> <li>默认保存 1000 条 /etc/profile HISSIZE=10000</li></ul> <h3 id="_1-8-调用"><a href="#_1-8-调用" class="header-anchor">#</a> 1.8 调用</h3> <ul><li>使用上下箭头调用以前的历史命令</li> <li>使用 !n 重复执行第 n 条历史命令</li> <li>使用 !! 重复执行上一条命令</li> <li>使用 !字符 重复执行最后一条以该字符串开头的命令</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">history</span> -c
<span class="token number">1</span> <span class="token builtin class-name">echo</span> <span class="token number">1</span>
<span class="token number">2</span> <span class="token builtin class-name">echo</span> <span class="token number">2</span>
<span class="token number">3</span> <span class="token builtin class-name">echo</span> <span class="token number">3</span>
<span class="token operator">!</span><span class="token number">2</span>
<span class="token operator">!</span><span class="token operator">!</span>
<span class="token operator">!</span>echo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_1-9-输出重定向"><a href="#_1-9-输出重定向" class="header-anchor">#</a> 1.9 输出重定向</h3> <h4 id="_1-9-1-标准输入输出"><a href="#_1-9-1-标准输入输出" class="header-anchor">#</a> 1.9.1 标准输入输出</h4> <table><thead><tr><th>设备</th> <th>设备文件名</th> <th>文件描述符</th> <th>类型</th></tr></thead> <tbody><tr><td>键盘</td> <td>/dev/stdin</td> <td>0</td> <td>标准输入</td></tr> <tr><td>显示器</td> <td>/dev/stdout</td> <td>1</td> <td>标准输出</td></tr> <tr><td>显示器</td> <td>/dev/stderr</td> <td>2</td> <td>标准错误输出</td></tr> <tr><td>类型</td> <td>符号</td> <td>作用</td> <td></td></tr> <tr><td>--</td> <td>--</td> <td></td> <td></td></tr> <tr><td>标准输出重定向</td> <td>命令 &gt; 文件</td> <td>以覆盖的方式，把命令的正确输出输出到指定的文件或设备当中</td> <td></td></tr> <tr><td>标准输出重定向</td> <td>命令 &gt;&gt; 文件</td> <td>以追加的方式，把命令的正确输出输出到指定的文件或设备当中</td> <td></td></tr> <tr><td>错误输出重定向</td> <td>命令&gt;文件</td> <td>以覆盖的方式，把命令的错误输出输出到指定的文件或设备当中</td> <td></td></tr> <tr><td>错误输出重定向</td> <td>命令&gt;&gt;文件</td> <td>以追加的方式，把命令的错误输出输出到指定的文件或设备当中</td> <td></td></tr> <tr><td>正确输出和错误输出同时保存</td> <td>命令&gt;文件 2&gt;&amp;1</td> <td>以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中</td> <td></td></tr> <tr><td>正确输出和错误输出同时保存</td> <td>命令&gt;文件 2&gt;&gt;&amp;1</td> <td>以追加的方式，把正确输出和错误输出都保存到同一个文件当中</td> <td></td></tr> <tr><td>正确输出和错误输出同时保存</td> <td>命令&amp;&gt;文件</td> <td>以覆盖的方式，把正确输出和错误输出都保存到同一个文件当中</td> <td></td></tr> <tr><td>正确输出和错误输出同时保存</td> <td>命令&amp;&gt;&gt;文件</td> <td>以追加的方式，把正确输出和错误输出都保存到同一个文件当中</td> <td></td></tr> <tr><td>正确输出和错误输出同时保存</td> <td>命令&gt;&gt;文件 1 2&gt;文件 2</td> <td>以覆盖的方式，正确的输出追加到文件 1 中，把错误输出追加到文件 2 中</td> <td></td></tr></tbody></table> <h4 id="_1-9-2-输入重定向"><a href="#_1-9-2-输入重定向" class="header-anchor">#</a> 1.9.2 输入重定向</h4> <ul><li>wc 命令的功能为统计指定文件中的行数、字数、字节数, 并将统计结果显示输出</li> <li>命令 &lt; 文件把文件做为命令的输入</li> <li>命令 &lt;&lt; 标识符 标识符把标识符之间内容作为命令的输入</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>- <span class="token function">wc</span> <span class="token operator">&lt;</span> access.log
  <span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># wc &lt;&lt;!</span>

  <span class="token operator">&gt;</span> hello world
  <span class="token operator">&gt;</span> <span class="token operator">!</span>
  <span class="token operator">&gt;</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">12</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_1-10-管道符号"><a href="#_1-10-管道符号" class="header-anchor">#</a> 1.10 管道符号</h3> <h4 id="_1-10-1-多命令顺序执行"><a href="#_1-10-1-多命令顺序执行" class="header-anchor">#</a> 1.10.1 多命令顺序执行</h4> <table><thead><tr><th>多命令执行符</th> <th>格式</th> <th>作用</th> <th>案例</th></tr></thead> <tbody><tr><td>;</td> <td>命令 1;命令 2</td> <td>多个命令执行，命令之间没有任何逻辑联系</td> <td>echo 1;echo 2;</td></tr> <tr><td>&amp;&amp;</td> <td>命令 1&amp;&amp;命令 2</td> <td>逻辑与 当命令 1 正确执行，则命令 2 才会执行 当命令 1 执行不正确，则命令 2 不会执行</td> <td>echo 1&amp;&amp;echo 2;</td></tr> <tr><td>\</td> <td>命令 1\ 命令 2</td> <td>逻辑或 当命令 1 执行不正确，则命令 2 才会执行 当命令 1 正确执行，则命令 2 不会执行</td> <td>echo 1\echo 2;</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>- <span class="token function">date</span><span class="token punctuation">;</span><span class="token function">ls</span><span class="token punctuation">;</span><span class="token function">date</span><span class="token punctuation">;</span><span class="token function">ls</span>
- <span class="token function">ls</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token function">yes</span> <span class="token operator">||</span> <span class="token builtin class-name">echo</span> no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_1-10-2-管道符号"><a href="#_1-10-2-管道符号" class="header-anchor">#</a> 1.10.2 管道符号</h4> <ul><li>命令 1 的正确输出会作为命令 2 的操作对象</li> <li>命令 1|命令 2</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">ls</span> /etc/ <span class="token operator">|</span> <span class="token function">more</span>
<span class="token function">netstat</span> -an <span class="token operator">|</span> <span class="token function">grep</span> ESTABLISHED <span class="token operator">|</span> <span class="token function">wc</span> -l
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_1-10-3-通配符"><a href="#_1-10-3-通配符" class="header-anchor">#</a> 1.10.3 通配符</h4> <p>匹配文件名和目录名</p> <table><thead><tr><th>通配符</th> <th>作用</th></tr></thead> <tbody><tr><td>?</td> <td>匹配一个任意字符</td></tr> <tr><td>*</td> <td>匹配 0 个或任意字符，也就是可以匹配任意内容</td></tr> <tr><td>[]</td> <td>匹配中括号中任意一个字符</td></tr> <tr><td>[-]</td> <td>匹配中括号中任意一个字符,-代表范围</td></tr> <tr><td>[^]</td> <td>匹配不是中括号中的一个字符</td></tr></tbody></table> <h4 id="_1-10-4-其它符号"><a href="#_1-10-4-其它符号" class="header-anchor">#</a> 1.10.4 其它符号</h4> <table><thead><tr><th>符号</th> <th>作用</th></tr></thead> <tbody><tr><td>''</td> <td>单引号。在单引号中所有的特殊符号，如$和`都没有特殊含义</td></tr> <tr><td>&quot;&quot;</td> <td>双引号，在双引号里特殊符号都没有特殊含义，但是 $ ` \ 例外，拥有调用变量值，引用命令和转义的含义</td></tr> <tr><td>``</td> <td>反引号，扩起来的是系统命令</td></tr> <tr><td>$()</td> <td>和反引号一样</td></tr> <tr><td>#</td> <td>在 shell 脚本中，#开头的行代表注释</td></tr> <tr><td>$</td> <td>用于调用变量的值</td></tr> <tr><td>\</td> <td>转义符号</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>- <span class="token assign-left variable">a</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ls</span><span class="token variable">`</span></span>
- <span class="token assign-left variable">b</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ls</span><span class="token variable">)</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_2-变量"><a href="#_2-变量" class="header-anchor">#</a> 2. 变量</h2> <h3 id="_2-1-什么是变量"><a href="#_2-1-什么是变量" class="header-anchor">#</a> 2.1 什么是变量</h3> <ul><li>可以变化的量</li> <li>变量必须以字母或下划线开头，名字中间只能由字母，数字和下划线组成</li> <li>变量名的长度不得超过 255 个字符</li> <li>变量名在有效范围内必须唯一</li> <li>变量默认类型都是字符串</li></ul> <h3 id="_2-2-变量的分类"><a href="#_2-2-变量的分类" class="header-anchor">#</a> 2.2 变量的分类</h3> <ul><li>字符串</li> <li>整型</li> <li>浮点型</li> <li>日期型</li></ul> <h3 id="_2-3-用户自定义变量"><a href="#_2-3-用户自定义变量" class="header-anchor">#</a> 2.3 用户自定义变量</h3> <ul><li>这些变量的值是自己定义的</li> <li>变量名不能为数字开头</li> <li>等号左右两边不能有空格</li></ul> <h4 id="_2-3-1-定义变量"><a href="#_2-3-1-定义变量" class="header-anchor">#</a> 2.3.1 定义变量</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;xiaoming&quot;</span>
<span class="token assign-left variable">age</span><span class="token operator">=</span><span class="token number">10</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_2-3-2-输出变量值"><a href="#_2-3-2-输出变量值" class="header-anchor">#</a> 2.3.2 输出变量值</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> $变量名
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-3-3-值默认都是字符串"><a href="#_2-3-3-值默认都是字符串" class="header-anchor">#</a> 2.3.3 值默认都是字符串</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>$ <span class="token assign-left variable">x</span><span class="token operator">=</span><span class="token number">1</span>
$ <span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token number">2</span>
$ <span class="token assign-left variable">z</span><span class="token operator">=</span><span class="token number">3</span>
$ <span class="token assign-left variable">z</span><span class="token operator">=</span><span class="token variable">$x</span>+<span class="token variable">$y</span>+<span class="token variable">$z</span>
$ <span class="token builtin class-name">echo</span> <span class="token variable">$z</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_3-4-在赋值的时候引用变量"><a href="#_3-4-在赋值的时候引用变量" class="header-anchor">#</a> .3.4 在赋值的时候引用变量</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$y</span>&quot;</span><span class="token number">2</span>
<span class="token assign-left variable">y</span><span class="token operator">=</span><span class="token variable">${y}</span><span class="token number">2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_2-3-5-set"><a href="#_2-3-5-set" class="header-anchor">#</a> 2.3.5 set</h4> <ul><li>查询系统中默认所有已经生效的变量，包括系统变量,也包括自定义变量</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">set</span> <span class="token operator">|</span> <span class="token function">grep</span> zhufeng
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>$ <span class="token builtin class-name">set</span> -u
$ <span class="token builtin class-name">echo</span> <span class="token variable">$a</span>
bash: a: unbound variable
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_2-3-6-unset"><a href="#_2-3-6-unset" class="header-anchor">#</a> 2.3.6 unset</h4> <ul><li>删除变量</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">unset</span> a
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-4-环境变量"><a href="#_2-4-环境变量" class="header-anchor">#</a> 2.4 环境变量</h3> <ul><li>环境变量是全局变量，而自定义变量是局部变量</li> <li>自定义变量会在当前的 shell 中生效，而环境变量会在当前 shell 以及其子 shell 中生效</li> <li>这种变量主要保存的是和系统操作环境相关的数据</li> <li>变量可以自定义，但是对系统生效的环境变量名和变量作用是固定的</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">bash</span>
pstree
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_2-4-1-自定义环境变量"><a href="#_2-4-1-自定义环境变量" class="header-anchor">#</a> 2.4.1 自定义环境变量</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">export</span> 变量名<span class="token operator">=</span>变量值
<span class="token builtin class-name">export</span> <span class="token assign-left variable">envname</span><span class="token operator">=</span>prod
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_2-4-2-env"><a href="#_2-4-2-env" class="header-anchor">#</a> 2.4.2 env</h4> <p>仅仅用来查看环境变量，而不看到本地变量</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">env</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-4-3-常用环境变量"><a href="#_2-4-3-常用环境变量" class="header-anchor">#</a> 2.4.3 常用环境变量</h4> <table><thead><tr><th>变量名</th> <th>含义</th> <th>示例</th></tr></thead> <tbody><tr><td>HOSTNAME</td> <td>主机名</td> <td>HOSTNAME=localhost</td></tr> <tr><td>SHELL</td> <td>当前的</td> <td>shell SHELL=/bin/bash</td></tr> <tr><td>TERM</td> <td>终端环境</td> <td>TERM=xterm</td></tr> <tr><td>HISTSIZE</td> <td>历史命令条数</td> <td>HISTSIZE=1000</td></tr> <tr><td>SSH_CLIENT</td> <td>当前操作环境如果是用</td> <td>SSH 连接的话，这里会记录客户端 IP SSH_CLIENT=192.168.1.100 57596 22</td></tr> <tr><td>SSH_TTY</td> <td>SSH 连接的终端</td> <td>SSH_TTY=/dev/pts/1</td></tr> <tr><td>USER</td> <td>当前登录的用户</td> <td>USER=root</td></tr></tbody></table> <h4 id="_2-4-4-path"><a href="#_2-4-4-path" class="header-anchor">#</a> 2.4.4 path</h4> <p>系统搜索路径</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># echo $PATH</span>

/usr/lib/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>如果想把一个自定义的脚本直接可以执行，或者把这个文件拷贝到目标目录下，或者把脚本所在目录添加到环境变量中的 PATH 路径中</p> <p>hello.sh</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">echo</span> helloc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code>./hello.sh
/root/myshell/hello.sh
<span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PATH</span></span><span class="token operator">=</span><span class="token string">&quot;<span class="token environment constant">$PATH</span>&quot;</span>:/root/myshell 临时生效
hello.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_2-4-5-ps1"><a href="#_2-4-5-ps1" class="header-anchor">#</a> 2.4.5 $PS1</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># echo $PS1</span>

<span class="token punctuation">[</span><span class="token punctuation">\</span>u@<span class="token punctuation">\</span>h <span class="token punctuation">\</span>W<span class="token punctuation">]</span><span class="token punctuation">\</span>$
root@localhost myshell<span class="token punctuation">]</span><span class="token comment">#</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><table><thead><tr><th>变量</th> <th>提示符</th></tr></thead> <tbody><tr><td>\d</td> <td>显示日期，格式为&quot;星期 月 日&quot;</td></tr> <tr><td>\H</td> <td>完整的主机名</td></tr> <tr><td>\t</td> <td>24 小时制时间,格式为 &quot;HH:MM:SS&quot;</td></tr> <tr><td>\A</td> <td>24 小时制时间，格式为 &quot;HH:MM&quot;</td></tr> <tr><td>\u</td> <td>显示当前用户名</td></tr> <tr><td>\w</td> <td>显示所在目录完整名称</td></tr> <tr><td>\W</td> <td>显示所在目录的最后一个目录</td></tr> <tr><td>$</td> <td>提示符，root 为#,普通用户为$</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable"><span class="token environment constant">PS1</span></span><span class="token operator">=</span>'<span class="token punctuation">[</span><span class="token punctuation">\</span>u@<span class="token punctuation">\</span>h <span class="token punctuation">\</span>w<span class="token punctuation">]</span><span class="token punctuation">\</span>$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_2-4-6-语系环境变量"><a href="#_2-4-6-语系环境变量" class="header-anchor">#</a> 2.4.6 语系环境变量</h4> <ul><li>查询当前系统语系</li> <li>在 Linux 中通过 locale 来设置程序运行的不同语言环境，locale 由 ANSI C 提供支持。locale 的命名规则为&lt;语言&gt;_&lt;地区&gt;.&lt;字符集编码&gt;，如 zh_CN.UTF-8，zh 代表中文，CN 代表大陆地区，UTF-8 表示字符集。</li> <li>LANG: 定义系统主语系的变量</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>locale
<span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>zh_CN.UTF-8

<span class="token builtin class-name">echo</span> <span class="token environment constant">$LANG</span>

下次开机之后我们系统环境
<span class="token function">cat</span> /etc/sysconfig/i18n
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_2-4-7-中文支持"><a href="#_2-4-7-中文支持" class="header-anchor">#</a> 2.4.7 中文支持</h4> <ul><li>图形界面可以支持中文</li> <li>第三方工具比如 xshell 语系设置正确可以支持中文</li> <li>虚拟机中的纯字符界面不支持中文</li></ul> <h3 id="_2-5-位置参数变量"><a href="#_2-5-位置参数变量" class="header-anchor">#</a> 2.5 位置参数变量</h3> <p>这种变量主要是用来向脚本当中传递参数或数据的,变量名不能自定义,变量作用是固定的</p> <table><thead><tr><th>位置参数变量</th> <th>作用</th></tr></thead> <tbody><tr><td>$n</td> <td>n为数字，$0代表命令本身，$1-$9代表第1到第9个参数，10以上的参数需要用大括号包含,如${10}</td></tr> <tr><td>$*</td> <td>这个变量代表命令中所有的参数，$*把所有的变看数看成一个整体</td></tr> <tr><td>$@</td> <td>这个变量也代表命令行中所有的参数，不过$@把每个参数进行区分</td></tr> <tr><td>$#</td> <td>这个变量代表命令行中所有参数的个数</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">num1</span><span class="token operator">=</span><span class="token variable">$1</span>
<span class="token assign-left variable">num2</span><span class="token operator">=</span><span class="token variable">$2</span>
<span class="token assign-left variable">sum</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>num1<span class="token operator">+</span>num2<span class="token variable">))</span></span>
<span class="token builtin class-name">echo</span> <span class="token variable">$sum</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token string">&quot;<span class="token variable">$@</span>&quot;</span>
<span class="token keyword">do</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;i=<span class="token variable">$i</span>&quot;</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_2-6-预定义变量"><a href="#_2-6-预定义变量" class="header-anchor">#</a> 2.6 预定义变量</h3> <p>是脚本中已经定义好的变量，变量名不能自定义，变量作用也是固定的</p> <table><thead><tr><th>位置参数变量</th> <th>作用</th></tr></thead> <tbody><tr><td>$?</td> <td>最后一次执行的命令的返回状态。0 表示正确执行，非 0 表示不正确执行</td></tr> <tr><td>$$</td> <td>当前进程的进程号(PID)</td></tr> <tr><td>$!</td> <td>后台运行的最后一个进程号(PID)]</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">ls</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token function">yes</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_2-7-read"><a href="#_2-7-read" class="header-anchor">#</a> 2.7 read</h3> <p>read [选项] [变量名]</p> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>-p</td> <td>提示信息，在等待 read 输入时，输出提示信息</td></tr> <tr><td>-t</td> <td>秒数: read 命令会一直等待用户输入，使用此选项可以指定等待时间</td></tr> <tr><td>-n</td> <td>字符数，read 命令只接受指定的字符数，就会执行</td></tr> <tr><td>-s</td> <td>隐藏输入的数据，适用于机密信息的输入</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">read</span> -p <span class="token string">'please input your name:'</span> -t <span class="token number">5</span> name
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token builtin class-name">read</span> -p <span class="token string">'please input you gender[m/f]:'</span> -n <span class="token number">1</span> gender
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token builtin class-name">read</span> -p <span class="token string">'please input your password:'</span> -s password
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\n">\n</span>&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$name</span>,<span class="token variable">$gender</span>,<span class="token variable">$password</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="_3-运算符"><a href="#_3-运算符" class="header-anchor">#</a> 3.运算符</h2> <p>弱类型并且默认是字符串类型</p> <h3 id="_3-1-declare-命令"><a href="#_3-1-declare-命令" class="header-anchor">#</a> 3.1 declare 命令</h3> <h4 id="_3-1-1-declare-命令"><a href="#_3-1-1-declare-命令" class="header-anchor">#</a> 3.1.1 declare 命令</h4> <ul><li>用来声明变量类型</li> <li>declare [+/-] [选项] 变量名</li></ul> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>-</td> <td>给变量设定类型属性</td></tr> <tr><td>+</td> <td>取消变量的类型属性</td></tr> <tr><td>-a</td> <td>将变量声明为数组类型</td></tr> <tr><td>-i</td> <td>将变量声明为整数型(integer)</td></tr> <tr><td>-x</td> <td>将变量声明为环境变量</td></tr> <tr><td>-r</td> <td>将变量声明为只读变量</td></tr> <tr><td>-p</td> <td>显示指定变量的被声明的类型</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>//声明成整型
<span class="token comment"># a=1</span>
<span class="token comment"># b=2</span>
<span class="token comment"># c=$a+$b</span>
<span class="token comment"># echo $c</span>
<span class="token number">1</span>+2
<span class="token comment"># declare -i c=$a+$b</span>
<span class="token comment"># echo $c</span>
<span class="token number">3</span>
<span class="token comment"># declare +i c</span>
<span class="token comment"># c=$a+$b</span>
<span class="token comment"># echo $c</span>
<span class="token number">1</span>+2
<span class="token comment"># declare -p c</span>
<span class="token builtin class-name">declare</span> -i <span class="token assign-left variable">c</span><span class="token operator">=</span><span class="token string">&quot;3&quot;</span>

//声明环境变量
<span class="token comment"># declare -x kk=1</span>
<span class="token comment"># bash</span>
<span class="token comment"># set | grep kk</span>

//只读
<span class="token comment"># declare -r x</span>
<span class="token comment"># x=2</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h4 id="_3-1-2-数组"><a href="#_3-1-2-数组" class="header-anchor">#</a> 3.1.2 数组</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>names<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>zhangsan
names<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>lisi
<span class="token comment"># 声明为数组类型</span>
<span class="token builtin class-name">declare</span> -a names<span class="token punctuation">;</span>
<span class="token comment"># 默认只打印第一个元素</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${names}</span>
zhangsan
打印第2个元素
<span class="token comment"># echo ${names[1]}</span>
lisi
<span class="token comment"># 打印全部</span>
<span class="token builtin class-name">echo</span> <span class="token variable">${names<span class="token punctuation">[</span>*<span class="token punctuation">]</span>}</span>
zhangsan lisi
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h4 id="_3-1-3-声明环境变量"><a href="#_3-1-3-声明环境变量" class="header-anchor">#</a> 3.1.3 声明环境变量</h4> <ul><li>export 最终执行的是 declare -x 命令</li> <li>declare -p 可以查看所有的类型</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">NAME</span><span class="token operator">=</span>zhufeng
<span class="token builtin class-name">declare</span> -x <span class="token assign-left variable">NAME</span><span class="token operator">=</span>zhufeng
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_3-1-4-只读属性"><a href="#_3-1-4-只读属性" class="header-anchor">#</a> 3.1.4 只读属性</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment">#declare -r gender=m</span>
<span class="token comment">#gender=f</span>
-bash: gender: <span class="token builtin class-name">readonly</span> variable
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_3-1-5-查询变量属性"><a href="#_3-1-5-查询变量属性" class="header-anchor">#</a> 3.1.5 查询变量属性</h4> <ul><li>declare -p 查询所有变量的属性</li> <li>declare -p 变量名 查询指定变量的属性</li></ul> <h3 id="_3-2-数值运算的方法"><a href="#_3-2-数值运算的方法" class="header-anchor">#</a> 3.2 数值运算的方法</h3> <p>只要用 declare 声明变量的时候指定类型就可以进行数值运算</p> <h4 id="_3-2-1-expr-或-let"><a href="#_3-2-1-expr-或-let" class="header-anchor">#</a> 3.2.1 expr 或 let</h4> <p>号左右两侧必须有空格,否则还是整块输出</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment">#num1=2</span>
<span class="token comment">#num2=3</span>
<span class="token comment">#s=$(expr $num1 + $num2)</span>
<span class="token comment">#echo $s</span>
<span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment">#s=$(($num1+$num2))</span>
<span class="token comment">#echo $s</span>
<span class="token number">5</span>
<span class="token comment">#s=$[$num1+$num2]</span>
<span class="token comment">#echo $s</span>
<span class="token number">5</span>

<span class="token assign-left variable">d</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token variable">$d</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_3-2-2-优先级"><a href="#_3-2-2-优先级" class="header-anchor">#</a> 3.2.2 优先级</h3> <p>priority</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">result</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span>\<span class="token operator">*</span><span class="token number">4</span><span class="token operator">/</span><span class="token number">2</span><span class="token variable">))</span></span>
<span class="token number">6</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="_4-环境变量配置文件"><a href="#_4-环境变量配置文件" class="header-anchor">#</a> 4. 环境变量配置文件</h2> <h3 id="_4-1-source-命令"><a href="#_4-1-source-命令" class="header-anchor">#</a> 4.1 source 命令</h3> <ul><li>修改完配置文件后，必须注销重新登录才能生效，使用 source 命令可以不用重新登录</li> <li>source 配置文件</li> <li>. 配置文件</li></ul> <h3 id="_4-2-环境变量配置文件简介"><a href="#_4-2-环境变量配置文件简介" class="header-anchor">#</a> 4.2 环境变量配置文件简介</h3> <ul><li><p>PATH、HISTSIZE、PS1、HOSTNAME 等环境变量写入对应的环境变量配置文件</p></li> <li><p>环境变量配置文件中主要是定义地系统操作环境生效的系统默认环境变量，如 PATH 等 此下文件登录时起作用的环境变量</p> <table><thead><tr><th>路径</th> <th>说明</th></tr></thead> <tbody><tr><td>/etc/profile</td> <td></td></tr> <tr><td>/etc/profile.d/*.sh</td> <td></td></tr> <tr><td>/etc/bashrc</td> <td></td></tr> <tr><td>~/.bash_profile</td> <td>只会对当前用户生效</td></tr> <tr><td>~/.bashrc</td> <td>只会对当前用户生效</td></tr></tbody></table></li></ul> <h3 id="_4-3-环境变量配置文件的功能"><a href="#_4-3-环境变量配置文件的功能" class="header-anchor">#</a> 4.3 环境变量配置文件的功能</h3> <h4 id="_4-3-1-etc-profile"><a href="#_4-3-1-etc-profile" class="header-anchor">#</a> 4.3.1 /etc/profile</h4> <p>在这里修改系统变量</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">cat</span> /etc/profile <span class="token operator">|</span> <span class="token function">grep</span> <span class="token environment constant">USER</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><table><thead><tr><th>变量名</th> <th>含义</th></tr></thead> <tbody><tr><td>USER</td> <td>用户名</td></tr> <tr><td>LOGNAME</td> <td>登录名</td></tr> <tr><td>MAIL</td> <td>邮箱地址</td></tr> <tr><td>PATH</td> <td>查找路径</td></tr> <tr><td>HOSTNAE</td> <td>主机名</td></tr> <tr><td>umask</td> <td>权限掩码</td></tr> <tr><td>/etc/profile.d/*.sh</td> <td></td></tr></tbody></table> <h4 id="_4-3-2-bash-profile"><a href="#_4-3-2-bash-profile" class="header-anchor">#</a> 4.3.2 ~/.bash_profile</h4> <ul><li>PATH 在这里修改 PATH 路径</li> <li>调用 ~/.bashrc</li></ul> <h4 id="_4-3-3-bashrc"><a href="#_4-3-3-bashrc" class="header-anchor">#</a> 4.3.3 ~/.bashrc</h4> <ul><li>配置 alias 改别名在这里</li> <li>调用 /etc/bashrc</li></ul> <h4 id="_4-3-4-etc-bashrc"><a href="#_4-3-4-etc-bashrc" class="header-anchor">#</a> 4.3.4 /etc/bashrc</h4> <ul><li>PS1 登录提示符在这里修改</li> <li>umask</li> <li>PATH 变量</li> <li>调用 /etc/profile.d/星.sh 文件</li></ul> <h4 id="_4-3-5-其它配置文件"><a href="#_4-3-5-其它配置文件" class="header-anchor">#</a> 4.3.5. 其它配置文件</h4> <h5 id="_4-3-5-1-注销时生效的环境变量配置文件"><a href="#_4-3-5-1-注销时生效的环境变量配置文件" class="header-anchor">#</a> 4.3.5.1 注销时生效的环境变量配置文件</h5> <p>~/.bash_logout</p> <h5 id="_4-3-5-2-脚本历史"><a href="#_4-3-5-2-脚本历史" class="header-anchor">#</a> 4.3.5.2 脚本历史</h5> <p>当正确退出计算机的时候会历史记录会写入文件 ~/.bash_history</p> <h5 id="_4-3-5-3-shell-登录信息"><a href="#_4-3-5-3-shell-登录信息" class="header-anchor">#</a> 4.3.5.3 Shell 登录信息</h5> <p>本地终端欢迎信息 /etc/issue 远程终端欢迎信息 /etc/issue.net 不管远程还是本地都可以生效 /etc/motd</p> <table><thead><tr><th>参数</th> <th>含义</th></tr></thead> <tbody><tr><td>\d</td> <td>当前系统日期</td></tr> <tr><td>\s</td> <td>显示操作系统名称</td></tr> <tr><td>\l</td> <td>显示登录的终端号</td></tr> <tr><td>\m</td> <td>显示硬件体系结构，如 i386 等</td></tr> <tr><td>\n</td> <td>显示主机名</td></tr> <tr><td>\o</td> <td>显示域名</td></tr> <tr><td>\r</td> <td>显示内核版本</td></tr> <tr><td>\t</td> <td>显示当前系统时间</td></tr> <tr><td>\u</td> <td>显示当前登录用户的序列号</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">vi</span> /etc/ssh/sshd_config
Banner /etc/issue.net
<span class="token function">service</span> sshd restart <span class="token number">4</span>.正则表达式
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>regexper</p> <h3 id="_4-1-概念"><a href="#_4-1-概念" class="header-anchor">#</a> 4.1 概念</h3> <ul><li>正则表达式是用于描述字符排列和匹配模式的一种语法规则</li> <li>它主要用于字符串的模式分割、匹配查找及替换操作</li></ul> <h3 id="_4-2-通配符"><a href="#_4-2-通配符" class="header-anchor">#</a> 4.2 通配符</h3> <ul><li>通配符用来匹配符合条件的文件名，通配符是完全匹配。</li> <li>ls find 这些命令不支持正则，只能使用通配符</li></ul> <table><thead><tr><th>符号</th> <th>含义</th></tr></thead> <tbody><tr><td>?</td> <td>匹配任意一个字符</td></tr> <tr><td>*</td> <td>匹配任意多个字符</td></tr> <tr><td>[]</td> <td>匹配中括号中范围内的一个字符</td></tr></tbody></table> <h3 id="_4-3-正则表达式"><a href="#_4-3-正则表达式" class="header-anchor">#</a> 4.3 正则表达式</h3> <ul><li>正则表达式是用来在文件中匹配符合条件的字符串，是包含匹配。</li> <li>grep awk sed 等都可以支持正则表达式</li></ul> <h3 id="_4-4-元字符"><a href="#_4-4-元字符" class="header-anchor">#</a> 4.4 元字符</h3> <p>alias grep='grep --color=auto'</p> <table><thead><tr><th>元字符</th> <th>作用</th> <th>示例</th></tr></thead> <tbody><tr><td>*</td> <td>前一个字符匹配 0 次或任意多次</td> <td>grep 1* reg.txt</td></tr> <tr><td>.</td> <td>匹配除换行符外的任意一个字符</td> <td>grep . reg.txt</td></tr> <tr><td>^</td> <td>匹配行首。例如，^hello 会匹配以 hello 开头的行</td> <td>grep ^a reg.txt</td></tr> <tr><td>$</td> <td>匹配行尾。例如，hello&amp; 会匹配以 hello 结尾的行</td> <td>grep a$ reg.txt</td></tr> <tr><td>[]</td> <td>匹配屮柄号屮指定的任意一个字符，而且只匹配一个字符。例如.[aoeiu]匹配任意一个元音字母， [0-9] 匹配任意一位数字，[a-z][0-9] 匹配由小写字母和一位数字构成的两位字符</td> <td>grep ab[bc]c reg.txt</td></tr> <tr><td>[^]</td> <td>匹配除中括号中的字符以外的任意一个字符。例如，[^0-9] 匹配任意一位非数字字符，[^a-z] 匹配任意一位非小写字母</td> <td>grep a[^fg]c reg.txt</td></tr> <tr><td>\</td> <td>转义符，用于取消特殊符号的含义</td> <td>grep .$ reg.txt</td></tr> <tr><td>{n}</td> <td>表示其前面的字符恰好出现 n 次。例如，[0-9]{4} 匹配 4 位数字，[1][3-8][0-9]{9} 匹配手机号码</td> <td>grep &quot;a{1}&quot; reg.txt</td></tr> <tr><td>(n,}</td> <td>表示其前面的字符出现不少于 n 次。例如，[0-9]{2,} 匹配两位及以上的数字</td> <td>grep &quot;a{1,}&quot; reg.txt</td></tr> <tr><td>{n,m}</td> <td>表示其前面的字符至少出现 n 次，最多出现 m 次。例如，[a-z]{6,8} 匹配 6〜8 位的小写字母</td> <td>grep &quot;a{2,3}&quot; reg.txt</td></tr></tbody></table> <h3 id="_4-5-cut"><a href="#_4-5-cut" class="header-anchor">#</a> 4.5 cut</h3> <ul><li>cut 用来提取文本中的某一部分文本</li> <li>cut [选项] 文件名</li> <li>-f 列号，用来指定要提取的列</li> <li>-d 分隔符，按照指定分隔符分割列,默认分隔符是 TAB 制表符</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">cat</span> /etc/passwd <span class="token operator">|</span> <span class="token function">grep</span> /bin/bash <span class="token operator">|</span> <span class="token function">cut</span> -f <span class="token number">1,2</span> -d <span class="token builtin class-name">:</span>
<span class="token function">df</span> -h <span class="token operator">|</span> <span class="token function">grep</span> /dev/sda5 <span class="token operator">|</span> <span class="token function">cut</span> -f <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_4-6-printf"><a href="#_4-6-printf" class="header-anchor">#</a> 4.6 printf</h3> <ul><li>按规定格式输出</li> <li>printf 输出类型 输出内容
<table><thead><tr><th>参数</th> <th>含义</th></tr></thead> <tbody><tr><td>%ns</td> <td>输出字符串,n 是数字指代输出几个字符</td></tr> <tr><td>%ni</td> <td>输出整数,n 是指输出几个数字</td></tr> <tr><td>%m.nf</td> <td>输出浮点数,m 和 n 是数字，指代输出的整数位数和小数位数，如%6.2f 代表输出 6 位位，2 位小数，4 位整数</td></tr></tbody></table></li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">printf</span> <span class="token string">&quot;%s<span class="token entity" title="\t">\t</span>%s<span class="token entity" title="\t">\t</span>%s<span class="token entity" title="\t">\t</span>%s<span class="token entity" title="\t">\t</span>%s<span class="token entity" title="\t">\t</span>\%s<span class="token entity" title="\n">\n</span>&quot;</span> <span class="token variable"><span class="token variable">$(</span><span class="token function">df</span> -h <span class="token operator">|</span> <span class="token function">grep</span> /dev/sda5<span class="token variable">)</span></span> <span class="token operator">|</span> <span class="token function">cut</span> -f <span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_4-7-awk"><a href="#_4-7-awk" class="header-anchor">#</a> 4.7 awk</h3> <ul><li>awk '条件 1{动作 1} 条件 2{动作 2}...' 文件名</li> <li>条件(Pattern)
<ul><li>一般使用关系表达式作为条件</li> <li>x &gt; 10 判断变量 x 是否大于 10</li> <li>x &gt;=10 大于等于</li> <li>x &lt;=10 小于等于</li></ul></li> <li>动作(Action)
<ul><li>格式化输出</li></ul></li> <li>$0 整行 $1 第一列...</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">df</span> -h <span class="token operator">|</span> <span class="token function">grep</span> /dev/sda5 <span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'{print $5}'</span><span class="token operator">|</span> <span class="token function">cut</span> -d <span class="token string">'%'</span> -f <span class="token number">1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_4-7-1-begin-end"><a href="#_4-7-1-begin-end" class="header-anchor">#</a> 4.7.1 begin end</h4> <ul><li>awk 可以正确截取制表符和空格</li> <li>begin 在所有的输出之前打印</li> <li>end 在所有的输出之后打印</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">awk</span> <span class="token string">'BEGIN{print &quot;开始&quot;}END{print &quot;结束&quot;}'</span> numbers.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_4-7-2-fs"><a href="#_4-7-2-fs" class="header-anchor">#</a> 4.7.2 FS</h3> <ul><li>Field Separator，字段分隔符</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">awk</span> <span class="token string">'BEGIN{FS=&quot;:&quot;}{print $1&quot;\t&quot;$2}'</span> /etc/passwd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_4-7-3-声明变量"><a href="#_4-7-3-声明变量" class="header-anchor">#</a> 4.7.3 声明变量</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">awk</span> <span class="token string">'BEGIN{sum=0}{sum=sum+$1}END{print sum}'</span> numbers.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_4-7-4-多条件"><a href="#_4-7-4-多条件" class="header-anchor">#</a> 4.7.4 多条件</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">awk</span> <span class="token string">'$2&gt;90{print $1&quot;\t 优秀&quot;}$2&gt;80{print $2&quot;\t 良好&quot;}'</span> score.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_4-7-5-nr"><a href="#_4-7-5-nr" class="header-anchor">#</a> 4.7.5 NR</h3> <p>NR,表示 awk 开始执行程序后所读取的数据行数</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">awk</span> <span class="token string">'{print NR,$0}'</span> file1
<span class="token function">awk</span> <span class="token string">'NR=3{print $0}'</span> file1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_4-7-6-ofs"><a href="#_4-7-6-ofs" class="header-anchor">#</a> 4.7.6 OFS</h3> <p>OFS Out of Field Separator，输出字段分隔符</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> <span class="token string">&quot;i love you&quot;</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'BEGIN{ FS=&quot; &quot;;OFS=&quot;-&quot; }{ print $1,$2,$3}'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="_4-8-sed-命令"><a href="#_4-8-sed-命令" class="header-anchor">#</a> 4.8 sed 命令</h3> <ul><li>sed 是一个轻量级编辑器，主要用来对数据进行选取、替换、替换和新增操作</li> <li>sed [选项] '[动作]' 文件名</li> <li>所有的动作都必须用单号号括起来</li> <li>类型类似于批量 vi 操作
选项</li></ul> <table><thead><tr><th>参数</th> <th>含义</th> <th>示例</th></tr></thead> <tbody><tr><td>-n</td> <td>一般 sed 命令会把所有的数据都输出到屏幕上，如果加入此选项则只会把处理过的行输出到屏幕上</td> <td>sed -n '2p' score.txt</td></tr> <tr><td>-e</td> <td>允许对输入数据应用多条 sed 编辑命令</td> <td>sed -e 's/75/70/g;s/55/50/g' score.txt</td></tr> <tr><td>-i</td> <td>用 sed 的修改直接修改编辑的文件，而不是在屏幕上输出</td> <td>sed -i '1i newline' score.txt</td></tr></tbody></table> <p>动作</p> <table><thead><tr><th>参数</th> <th>含义</th> <th>示例</th></tr></thead> <tbody><tr><td>a</td> <td>追加，在每一行或者指定行下面添加一行或多行</td> <td>sed '1a newline' score.txt</td></tr> <tr><td>c</td> <td>行替换，用 c 后面的字符串替换掉原始整个数据行</td> <td>sed 'c newline' score.txt</td></tr> <tr><td>s</td> <td>字符串替换,用一个字符串替换另外一个字符串，格式为 &quot;行范围 s/旧字符串/新字符串/g&quot;</td> <td>sed '3s/lisi/lisisi/g' score.txt</td></tr> <tr><td>i</td> <td>插入，在当前行插入一行或多行</td> <td>sed '1i newline' score.txt</td></tr> <tr><td>d</td> <td>删除指定的行</td> <td>sed '1,2d' score.txt</td></tr> <tr><td>p</td> <td>打印,输出指定的行</td> <td>sed -n '2p' score.txt</td></tr></tbody></table> <h3 id="_4-9-排序命令-sort"><a href="#_4-9-排序命令-sort" class="header-anchor">#</a> 4.9 排序命令 sort</h3> <ul><li>sort [选项] 文件名</li> <li>选项
<table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>-f</td> <td>忽略大小写</td></tr> <tr><td>-n</td> <td>以数值型进行排序，默认使用字符串顺序</td></tr> <tr><td>-r</td> <td>反向排序，默认从小到大</td></tr> <tr><td>-t</td> <td>指定分割符，默认分割符是制表符</td></tr> <tr><td>-k n[,m]</td> <td>按照指定的字段范围排序。从第 n 个字段开始，到第 m 个字段结束，默认是到行尾</td></tr></tbody></table></li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sort</span> /etc/passwd
<span class="token function">sort</span> -r /etc/passwd
<span class="token function">sort</span> -t <span class="token string">&quot;:&quot;</span> -k <span class="token number">3,3</span> /etc/passwd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_4-10-wc"><a href="#_4-10-wc" class="header-anchor">#</a> 4.10 wc</h3> <p>wc [选项] 文件名</p> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>-l</td> <td>只统计行数</td></tr> <tr><td>-w</td> <td>只允许单词数</td></tr> <tr><td>-m</td> <td>只统计字符数</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">wc</span> wc.txt
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_5-流程控制"><a href="#_5-流程控制" class="header-anchor">#</a> 5. 流程控制</h2> <h3 id="_5-1-条件判断"><a href="#_5-1-条件判断" class="header-anchor">#</a> 5.1 条件判断</h3> <h4 id="_5-1-1-按照文件类型进行判断"><a href="#_5-1-1-按照文件类型进行判断" class="header-anchor">#</a> 5.1.1 按照文件类型进行判断</h4> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>-d</td> <td>文件是否存在并且是目录</td></tr> <tr><td>-e</td> <td>文件是否存在</td></tr> <tr><td>-f</td> <td>文件是否存在并且是普通文件</td></tr> <tr><td>-b</td> <td>文件是否存在并且是块设备文件</td></tr> <tr><td>-c</td> <td>文件是否存在并且是字符设备文件</td></tr> <tr><td>-L</td> <td>文件是否存在并且是链接文件</td></tr> <tr><td>-p</td> <td>文件是否存在并且是管道文件</td></tr> <tr><td>-s</td> <td>文件是否存在并且是否为非空</td></tr> <tr><td>-S</td> <td>文件是否存在并且是套接字文件</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">test</span> -e <span class="token number">1</span>.txt
<span class="token punctuation">[</span>-e <span class="token number">1</span>.txt<span class="token punctuation">]</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$?</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># [ -e 1.txt ]&amp;&amp;echo &quot;yes&quot;|| echo &quot;no&quot;</span>
<span class="token function">yes</span>
<span class="token comment"># [ -e 11.txt ]&amp;&amp;echo &quot;yes&quot;|| echo &quot;no&quot;</span>
no
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_5-1-2-按照文件权限进行判断"><a href="#_5-1-2-按照文件权限进行判断" class="header-anchor">#</a> 5.1.2 按照文件权限进行判断</h4> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>-r</td> <td>文件是否存在，并且是否拥有读权限</td></tr> <tr><td>-w</td> <td>文件是否存在，并且是否拥有写权限</td></tr> <tr><td>-x</td> <td>文件是否存在，并且是否拥有执行权限</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> <span class="token builtin class-name">read</span> <span class="token operator">&gt;</span> read.txt
<span class="token builtin class-name">echo</span> <span class="token function">write</span> <span class="token operator">&gt;</span> write.txt
<span class="token builtin class-name">echo</span> execute <span class="token operator">&gt;</span> execute.txt

<span class="token function">chmod</span> u+w write.txt
<span class="token function">chmod</span> u+x execute.txt

<span class="token punctuation">[</span> -e read.txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;read yes&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">[</span> -e write.txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;write yes&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">[</span> -e execute.txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;execute yes&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_5-1-3-两个文件间的比较"><a href="#_5-1-3-两个文件间的比较" class="header-anchor">#</a> 5.1.3 两个文件间的比较</h4> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>文件 1 -nt 文件 2</td> <td>判断文件 1 的修改时间是否比文件 2 的新</td></tr> <tr><td>文件 1 -ot 文件 2</td> <td>判断文件 1 的修改时间是否比文件 2 的旧</td></tr> <tr><td>文件 1 -ef 文件 2</td> <td>判断文件 1 和文件 2 的 inode 号是否一致,可用于判断硬链接</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span> write.txt -nt read.txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;write is older than read&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">[</span> read.txt -ot write.txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;read is older than write&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token function">ln</span> execute.txt execute2.txt
<span class="token punctuation">[</span> execute.txt -ef execute2.txt <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;execute and execute2.txt are the same&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_5-1-4-两个整数间的比较"><a href="#_5-1-4-两个整数间的比较" class="header-anchor">#</a> 5.1.4 两个整数间的比较</h4> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>整数 1 -eq 整数 2</td> <td>判断整数 1 是否和整数 2 相等</td></tr> <tr><td>整数 1 -ne 整数 2</td> <td>判断整数 1 是否和整数 2 不相等</td></tr> <tr><td>整数 1 -gt 整数 2</td> <td>判断整数 1 是否大于整数 2</td></tr> <tr><td>整数 1 -lt 整数 2</td> <td>判断整数 1 是否小于整数 2</td></tr> <tr><td>整数 1 -ge 整数 2</td> <td>判断整数 1 是否大于等于整数 2</td></tr> <tr><td>整数 1 -le 整数 2</td> <td>判断整数 1 是否小于等于整数 2</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span> <span class="token number">2</span> -eq <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;2==2&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">[</span> <span class="token number">3</span> -ne <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;2!=2&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">[</span> <span class="token number">3</span> -gt <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;2&gt;2&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">[</span> <span class="token number">1</span> -lt <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;2&lt;2&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">[</span> <span class="token number">2</span> -ge <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;2&gt;=2&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">[</span> <span class="token number">2</span> -le <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;2&lt;=2&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_5-1-5-字符串的判断"><a href="#_5-1-5-字符串的判断" class="header-anchor">#</a> 5.1.5 字符串的判断</h4> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>-z 字符串</td> <td>判断字否串是否为空</td></tr> <tr><td>-n 字符中</td> <td>判断字符串是否为非空</td></tr> <tr><td>字符串 1 == 字符串 2</td> <td>判断字符串 1 是否和字符串 2 相等</td></tr> <tr><td>字符串 1 != 字符串 2</td> <td>判断字符串 1 是否和字符串 2 不相等</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token assign-left variable">name</span><span class="token operator">=</span>zhufeng
<span class="token punctuation">[</span> -z <span class="token string">&quot;<span class="token variable">$name</span>&quot;</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token assign-left variable">name2</span><span class="token operator">=</span>zhufeng
<span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$name</span>&quot;</span> <span class="token operator">==</span> <span class="token string">&quot;<span class="token variable">$name2</span>&quot;</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>5.1.6 多重条件判断</p> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>判断 1 -a 判断 2</td> <td>逻辑与</td></tr> <tr><td>判断 1 -o 判断 2</td> <td>逻辑或</td></tr> <tr><td>!判断</td> <td>逻辑非</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span> <span class="token number">2</span> -gt <span class="token number">1</span> -a <span class="token number">3</span> -gt <span class="token number">2</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">[</span> <span class="token number">2</span> -gt <span class="token number">1</span> -a <span class="token number">3</span> -gt <span class="token number">4</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">[</span> <span class="token number">2</span> -gt <span class="token number">1</span> -o <span class="token number">3</span> -gt <span class="token number">4</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token number">3</span> -gt <span class="token number">4</span> <span class="token punctuation">]</span><span class="token operator">&amp;&amp;</span><span class="token builtin class-name">echo</span> <span class="token string">&quot;yes&quot;</span><span class="token operator">||</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_5-2-单分支-if-语句"><a href="#_5-2-单分支-if-语句" class="header-anchor">#</a> 5.2 单分支 if 语句</h3> <ul><li>if 语句使用 fi 结尾</li> <li>[条件判断式]就是使用 test 命令进行判断，所以中括号和条件判断式之间必须有空格</li> <li>then 后面跟符合条件之后执行的程序，可以放在[]之后，用;分隔，也可以换行，不用;</li></ul> <h4 id="_5-2-1-语法"><a href="#_5-2-1-语法" class="header-anchor">#</a> 5.2.1 语法</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token keyword">if</span> <span class="token punctuation">[</span>条件判断<span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
代码体
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token keyword">if</span> <span class="token punctuation">[</span>条件判断<span class="token punctuation">]</span>
<span class="token keyword">then</span>
代码体
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token number">2</span> -gt <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span> <span class="token builtin class-name">echo</span> bigger<span class="token punctuation">;</span> <span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="_5-2-2-判断当前用户是否是-root-用户"><a href="#_5-2-2-判断当前用户是否是-root-用户" class="header-anchor">#</a> 5.2.2 判断当前用户是否是 root 用户</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">whoami</span><span class="token variable">)</span></span>
<span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">whoami</span><span class="token variable">`</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$user</span>&quot;</span> <span class="token operator">==</span> root <span class="token punctuation">]</span>
<span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;I am root&quot;</span>
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_5-3-双分支-if-语句"><a href="#_5-3-双分支-if-语句" class="header-anchor">#</a> 5.3 双分支 if 语句</h3> <h4 id="_5-3-1-语法"><a href="#_5-3-1-语法" class="header-anchor">#</a> 5.3.1 语法</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token keyword">if</span> <span class="token punctuation">[</span>条件判断<span class="token punctuation">]</span>
<span class="token keyword">then</span>
代码体 <span class="token number">1</span>
<span class="token keyword">else</span>
代码体 <span class="token number">2</span>
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_5-3-2-判断是否目录"><a href="#_5-3-2-判断是否目录" class="header-anchor">#</a> 5.3.2 判断是否目录</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">read</span> -t <span class="token number">10</span> -p <span class="token string">&quot;please input a filename&quot;</span> <span class="token function">dir</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> -d <span class="token string">&quot;<span class="token variable">$dir</span>&quot;</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;is directory&quot;</span>
<span class="token keyword">else</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;not a direcotry&quot;</span>
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_5-4-多分支-if-语句"><a href="#_5-4-多分支-if-语句" class="header-anchor">#</a> 5.4 多分支 if 语句</h3> <h4 id="_5-4-1-语法"><a href="#_5-4-1-语法" class="header-anchor">#</a> 5.4.1 语法</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token keyword">if</span> <span class="token punctuation">[</span>条件判断 <span class="token number">1</span><span class="token punctuation">]</span>
<span class="token keyword">then</span>
代码体 <span class="token number">1</span>
<span class="token keyword">elif</span> <span class="token punctuation">[</span>条件判断 <span class="token number">2</span><span class="token punctuation">]</span>
代码体 <span class="token number">2</span>
<span class="token keyword">else</span>
代码体 <span class="token number">3</span>
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">read</span> -p <span class="token string">&quot;please input a grade&quot;</span> grade
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$grade</span>&quot;</span> -gt <span class="token number">90</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> great
<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">$grade</span>&quot;</span> -gt <span class="token number">80</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> good
<span class="token keyword">else</span>
<span class="token builtin class-name">echo</span> bad
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="_5-5-case-语句"><a href="#_5-5-case-语句" class="header-anchor">#</a> 5.5 case 语句</h3> <p>case 和 if 都是多分支判断语句,if 能判断多个条件,case 只能判断一个条件</p> <h4 id="_5-5-1-语法"><a href="#_5-5-1-语法" class="header-anchor">#</a> 5.5.1 语法</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token keyword">case</span> 变量名 <span class="token keyword">in</span>
值 <span class="token number">1</span><span class="token punctuation">)</span>
代码块 <span class="token number">1</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>
值 <span class="token number">2</span><span class="token punctuation">)</span>
代码块 <span class="token number">2</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>
_<span class="token punctuation">)</span>
代码块 <span class="token number">3</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">read</span> -p <span class="token string">&quot;yes or no?&quot;</span> -t <span class="token number">30</span> choose
<span class="token keyword">case</span> <span class="token variable">$choose</span> <span class="token keyword">in</span>
<span class="token string">&quot;yes&quot;</span><span class="token punctuation">)</span>
<span class="token builtin class-name">echo</span> <span class="token string">'yes'</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token string">&quot;no&quot;</span><span class="token punctuation">)</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;no&quot;</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>
_<span class="token punctuation">)</span>
<span class="token builtin class-name">echo</span> other
<span class="token punctuation">;</span><span class="token punctuation">;</span>
<span class="token keyword">esac</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="_5-6-for-循环"><a href="#_5-6-for-循环" class="header-anchor">#</a> 5.6 for 循环</h3> <h4 id="_5-6-1-语法"><a href="#_5-6-1-语法" class="header-anchor">#</a> 5.6.1 语法</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token keyword">for</span> 变量 <span class="token keyword">in</span> 值 <span class="token number">1</span> 值 <span class="token number">2</span> 值 <span class="token number">3</span>
<span class="token keyword">do</span>
代码块
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> <span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span>
<span class="token keyword">do</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$i</span>
<span class="token keyword">done</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_5-6-2-语法"><a href="#_5-6-2-语法" class="header-anchor">#</a> 5.6.2 语法</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>
<span class="token comment">#!/bin/bash</span>

<span class="token keyword">for</span><span class="token variable"><span class="token punctuation">((</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span>i<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">;</span>i<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token punctuation">;</span>
<span class="token keyword">do</span>
<span class="token builtin class-name">echo</span> <span class="token variable"><span class="token variable">$((</span>$i<span class="token variable">))</span></span><span class="token punctuation">;</span> //加不加$都一样
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_5-7-while-循环"><a href="#_5-7-while-循环" class="header-anchor">#</a> 5.7 while 循环</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token keyword">while</span> 循环是不定循环，也称为条件循环，只要条件判断成立，就会一直继续
<span class="token keyword">while</span> <span class="token punctuation">[</span>条件判断式<span class="token punctuation">]</span>
<span class="token keyword">do</span>
代码块
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">result</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> -le <span class="token number">100</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
<span class="token assign-left variable">result</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$result<span class="token operator">+</span>i<span class="token variable">))</span></span>
<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$i<span class="token operator">+</span><span class="token number">1</span><span class="token variable">))</span></span>
<span class="token keyword">done</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$result</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_5-8-until-循环"><a href="#_5-8-until-循环" class="header-anchor">#</a> 5.8 until 循环</h3> <p>直到条件不成立停止</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token number">1</span>
<span class="token assign-left variable">result</span><span class="token operator">=</span><span class="token number">0</span>
<span class="token keyword">until</span> <span class="token punctuation">[</span> <span class="token variable">$i</span> -gt <span class="token number">100</span> <span class="token punctuation">]</span>
<span class="token keyword">do</span>
<span class="token assign-left variable">result</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$result<span class="token operator">+</span>i<span class="token variable">))</span></span>
<span class="token assign-left variable">i</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$i<span class="token operator">+</span><span class="token number">1</span><span class="token variable">))</span></span>
<span class="token keyword">done</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$result</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="_6-函数"><a href="#_6-函数" class="header-anchor">#</a> 6. 函数</h2> <ul><li>linux shell 可以用户定义函数，然后在 shell 脚本中可以随便调用</li> <li>可以带 function fun() 定义，也可以直接 fun() 定义,不带任何参数</li> <li>调用函数不需要加()</li></ul> <h3 id="_6-1-简单函数"><a href="#_6-1-简单函数" class="header-anchor">#</a> 6.1 简单函数</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span> <span class="token keyword">function</span> <span class="token punctuation">]</span> funcname <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">{</span>
action<span class="token punctuation">;</span>
<span class="token punctuation">[</span>return int<span class="token punctuation">;</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function-name function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>

<span class="token operator">&gt;</span> <span class="token builtin class-name">echo</span> start
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token operator">&gt;</span> <span class="token comment">#!/bin/bash</span>
<span class="token operator">&gt;</span> <span class="token function-name function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token builtin class-name">echo</span> start
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
<span class="token operator">&gt;</span> start
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_6-2-返回值"><a href="#_6-2-返回值" class="header-anchor">#</a> 6.2 返回值</h3> <p>参数返回，可以显示加：return 返回，如果不加，将以最后一条命令运行结果，作为返回值</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token operator">&gt;</span> <span class="token function-name function">sum4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token operator">&gt;</span> <span class="token assign-left variable">r</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$<span class="token number">1</span><span class="token operator">+</span>$<span class="token number">2</span><span class="token variable">))</span></span>
<span class="token operator">&gt;</span> <span class="token builtin class-name">return</span> <span class="token variable">$r</span>
<span class="token operator">&gt;</span> <span class="token punctuation">}</span>
<span class="token comment"># sum4 2 3</span>
<span class="token builtin class-name">echo</span> <span class="token variable">$?</span>
<span class="token number">5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_6-3-参数说明"><a href="#_6-3-参数说明" class="header-anchor">#</a> 6.3 参数说明</h3> <table><thead><tr><th>参数处理</th> <th>说明</th></tr></thead> <tbody><tr><td>$#</td> <td>传递到脚本的参数个数</td></tr> <tr><td>$*</td> <td>以一个单字符串显示所有向脚本传递的参数</td></tr> <tr><td>$@</td> <td>与$*相同，但是使用时加引号，并在引号中返回每个参数</td></tr> <tr><td>$$</td> <td>脚本运行的当前进程 ID 号</td></tr> <tr><td>$!</td> <td>后台运行的最后一个进程的 ID 号</td></tr> <tr><td>$-</td> <td>显示 Shell 使用的当前选项，与 set 命令功能相同</td></tr> <tr><td>$?</td> <td>显示最后命令的退出状态。0 表示没有错误，其他任何值表明有错误</td></tr></tbody></table> <h3 id="_6-4-profile"><a href="#_6-4-profile" class="header-anchor">#</a> 6.4 profile</h3> <ul><li>parameter-substitution</li> <li>shell 帮助文档</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> $-
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">${-<span class="token operator">#</span>\*i}</span>&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_6-4-1-脚本"><a href="#_6-4-1-脚本" class="header-anchor">#</a> 6.4.1 脚本</h4> <p>cat /etc/profile</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token keyword">for</span> <span class="token for-or-select variable">i</span> <span class="token keyword">in</span> /etc/profile.d/*.sh <span class="token punctuation">;</span> <span class="token keyword">do</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> -r <span class="token string">&quot;<span class="token variable">$i</span>&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">&quot;<span class="token variable">${-<span class="token operator">#</span>*i}</span>&quot;</span> <span class="token operator">!=</span> <span class="token string">&quot;$-&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
          <span class="token builtin class-name">.</span> <span class="token string">&quot;<span class="token variable">$i</span>&quot;</span>
<span class="token keyword">else</span>
<span class="token builtin class-name">.</span> <span class="token string">&quot;<span class="token variable">$i</span>&quot;</span> <span class="token operator">&gt;</span>/dev/null <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span>
<span class="token keyword">fi</span>
<span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>如果现在执行的命令(或脚本)是交互式（interactively），那么加载之</p> <p>如果执行的命令（或脚本）是非交互式（non-interactively），那么加载之，并且将输出重定向到 /dev/null,目的是防止有些执行某些程序（如 scp），需要登录到远端机器，读取远端机器的环境变量有输出，导致程序中断！</p> <h4 id="_6-4-2-打印当前-shell-的选项"><a href="#_6-4-2-打印当前-shell-的选项" class="header-anchor">#</a> 6.4.2 打印当前 shell 的选项</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># echo $-</span>
himBH
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>$-记录着当前设置的 shell 选项，himBH 是默认值，你可以通过 set 命令来设置或者取消一个选项配置。例如：</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">set</span> -x
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>这个可以打开 shell 的调试开关，调试 shell 脚本非常有用，这个时候再检查下 $- 变量的值，可以看到多了 x 字符：</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># echo $-</span>
+ <span class="token builtin class-name">echo</span> himxBH
himxBH
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="_6-4-3-选项"><a href="#_6-4-3-选项" class="header-anchor">#</a> 6.4.3 选项</h4> <p>查看当前 shell 的选项配置</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">set</span> -o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="_6-4-3-1-i-interactive"><a href="#_6-4-3-1-i-interactive" class="header-anchor">#</a> 6.4.3.1 i - interactive</h5> <p>包含这个选项说明当前的 shell 是一个交互式的 shell，何为交互式？你输入命令，shell 解释执行后给你返回结果，我们在 Terminal 下使用的 shell 就是交互式的 如果我们在一个脚本里面 echo $-，结果是不会包含 i 的</p> <h5 id="_6-4-3-2-h-history-expand"><a href="#_6-4-3-2-h-history-expand" class="header-anchor">#</a> 6.4.3.2 H - history expand</h5> <p>history expand 就是展开历史列表中的命令，可以通过!感叹号来完成，例如&quot;!!&quot;返回上最近的一个历史命令，&quot;!n&quot;返回第 n 个历史命令，等等</p> <h5 id="_6-4-3-3-b-brace-expansion"><a href="#_6-4-3-3-b-brace-expansion" class="header-anchor">#</a> 6.4.3.3 B - brace expansion</h5> <ul><li>大括号扩展，是可以让 bash 生成任意字符串的一种扩展功能</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> g<span class="token punctuation">{</span>a,b,c<span class="token punctuation">}</span>$
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="_6-4-3-4-m-monitor-mode"><a href="#_6-4-3-4-m-monitor-mode" class="header-anchor">#</a> 6.4.3.4 m - monitor mode</h5> <ul><li>打开监控模式,可以控制进程的停止、继续，后台或者前台执行</li> <li>正常情况下，在交互式模式下，该选项默认是打开的，所以再执行一个比较耗时的命令时，你可以按下 CTRL+Z 让它在后台运行，然后可以用 fg 命令将后台运行的任务恢复到前台执行</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">sleep</span> 10s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h5 id="_6-4-3-5-h-hashal"><a href="#_6-4-3-5-h-hashal" class="header-anchor">#</a> 6.4.3.5 h - hashal</h5> <p>Remember the location of commands as they are looked up for execution. This is enabled by default. 记录命令的位置</p> <h4 id="_6-4-4-删除"><a href="#_6-4-4-删除" class="header-anchor">#</a> 6.4.4 删除</h4> <p>从左往右看，删除掉 $- 变量的值中第一个 i 字符以及之前的内容</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token variable">${-<span class="token operator">#</span>\*i}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>%与#号的意义刚好相反，从右往左看，删除掉 $- 变量的值中最后一个 i 字符以及之后的内容</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token variable">${-<span class="token operator">%</span>i\*}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="_7-shell-实战"><a href="#_7-shell-实战" class="header-anchor">#</a> 7.shell 实战</h2> <h3 id="_7-1-注意事项"><a href="#_7-1-注意事项" class="header-anchor">#</a> 7.1 注意事项</h3> <ul><li>开头加解释器: #/bin/bash 和注释说明</li> <li>命名建议规则: 变量名大写、局部变量小写，函数名小写，名字体现出实际作用</li> <li>默认变量是全局的，在函数中变量 local 指定为局部变量，避免污染其它作用域</li> <li>set -e 遇到执行非 0 时退出脚本, set -x 打印执行过程</li> <li>写脚本一定要先测试再上生产环境</li></ul> <h3 id="_7-2-获取随机字符串或数字"><a href="#_7-2-获取随机字符串或数字" class="header-anchor">#</a> 7.2 获取随机字符串或数字</h3> <p>-c, --characters=LIST select only these characters</p> <h4 id="_7-2-1-获取随机-8-位字符串"><a href="#_7-2-1-获取随机-8-位字符串" class="header-anchor">#</a> 7.2.1 获取随机 8 位字符串</h4> <p>MD5 全称是报文摘要算法（Message-Digest Algorithm 5），此算法对任意长度的信息逐位进行计算，产生一个二进制长度为 128 位(十六进制长度就是 32 位)的报文摘要,不同的文件产生相同的报文摘要的可能性是非常非常之小的</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> <span class="token environment constant">$RANDOM</span> <span class="token operator">|</span>md5sum<span class="token operator">|</span><span class="token function">cut</span> -c <span class="token number">1</span>-8
<span class="token function">cat</span> /proc/sys/kernel/random/uuid <span class="token operator">|</span> <span class="token function">cut</span> -c <span class="token number">1</span>-8
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_7-2-2-获取随机-8-位数字"><a href="#_7-2-2-获取随机-8-位数字" class="header-anchor">#</a> 7.2.2 获取随机 8 位数字</h4> <ul><li>cksum 命令是确保文件从一个系统传输到另一个系统地过程中没有被损坏。这个测试要求校验和在源系统中被计算出来,在目的系统中又被计算一次，两个数字比较，如果校验和相等，则该文件被认为是被正确传输了</li> <li>%N 十亿分之一秒，纳秒 [000000000，999999999]</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> <span class="token environment constant">$RANDOM</span> <span class="token operator">|</span><span class="token function">cksum</span><span class="token operator">|</span><span class="token function">cut</span> -c <span class="token number">1</span>-8
<span class="token function">date</span> +%N <span class="token operator">|</span> <span class="token function">cut</span> -c <span class="token number">1</span>-8
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_7-3-定义一个颜色输出字符串函数"><a href="#_7-3-定义一个颜色输出字符串函数" class="header-anchor">#</a> 7.3 定义一个颜色输出字符串函数</h3> <ul><li>终端的字符颜色是用转义序列控制的，是文本模式下的系统显示功能</li> <li>转义序列是以 ESC 开头,即用\033 来完成（ESC 的 ASCII 码用十进制表示是 27，用八进制表示就是 033）</li> <li>书写格式: 开头部分：\033[显示方式;前景色;背景色 m + 结尾部分：\033[0m 显示方式</li></ul> <table><thead><tr><th>数值</th> <th>含义</th></tr></thead> <tbody><tr><td>0</td> <td>默认值</td></tr> <tr><td>1</td> <td>高亮</td></tr> <tr><td>22</td> <td>非粗体</td></tr> <tr><td>4</td> <td>下划线</td></tr> <tr><td>24</td> <td>非下划线</td></tr> <tr><td>5</td> <td>闪烁</td></tr> <tr><td>25</td> <td>非闪烁</td></tr> <tr><td>7</td> <td>反显</td></tr> <tr><td>27</td> <td>非反显</td></tr></tbody></table> <p>前景色</p> <table><thead><tr><th>数值</th> <th>含义</th></tr></thead> <tbody><tr><td>30</td> <td>黑色</td></tr> <tr><td>31</td> <td>红色</td></tr> <tr><td>32</td> <td>绿色</td></tr> <tr><td>33</td> <td>黄色</td></tr> <tr><td>34</td> <td>蓝色</td></tr> <tr><td>35</td> <td>洋红</td></tr> <tr><td>36</td> <td>青色</td></tr> <tr><td>37</td> <td>白色</td></tr></tbody></table> <p>背景色</p> <table><thead><tr><th>数值</th> <th>含义</th></tr></thead> <tbody><tr><td>40</td> <td>黑色</td></tr> <tr><td>41</td> <td>红色</td></tr> <tr><td>42</td> <td>绿色</td></tr> <tr><td>43</td> <td>黄色</td></tr> <tr><td>44</td> <td>蓝色</td></tr> <tr><td>45</td> <td>洋红</td></tr> <tr><td>46</td> <td>青色</td></tr> <tr><td>47</td> <td>白色</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\033">\033</span>[m hello <span class="token entity" title="\033">\033</span>[m&quot;</span>
显示方式: 正常 字体前景色：红色 背景色：青色
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\033">\033</span>[0;31;46m hello <span class="token entity" title="\033">\033</span>[m&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token comment">#description: test</span>
<span class="token keyword">function</span> <span class="token function-name function">echo_color</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$1</span> <span class="token operator">==</span> <span class="token string">&quot;green&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\033">\033</span>[32;40m<span class="token variable">$2</span><span class="token entity" title="\033">\033</span>[0m&quot;</span>
<span class="token keyword">elif</span> <span class="token punctuation">[</span> <span class="token variable">$1</span> <span class="token operator">==</span> <span class="token string">&quot;red&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\033">\033</span>[31;40m<span class="token variable">$2</span><span class="token entity" title="\033">\033</span>[0m&quot;</span>
<span class="token keyword">fi</span>
<span class="token punctuation">}</span>

<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\033">\033</span>[32;40mshell<span class="token entity" title="\033">\033</span>[0m&quot;</span>
<span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token entity" title="\033">\033</span>[33;40mshell<span class="token entity" title="\033">\033</span>[0m&quot;</span>

echo_color red hello
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="_7-4-批量创建用户"><a href="#_7-4-批量创建用户" class="header-anchor">#</a> 7.4 批量创建用户</h3> <ul><li>/dev/null 2&gt;&amp;1 这条命令的意思是将标准输出和错误输出全部重定向到/dev/null 中,也就是将产生的所有信息丢弃</li> <li>command &gt; file 2&gt;file 的意思是将命令所产生的标准输出信息,和错误的输出信息送到 file 中。 command &gt; file 2&gt;file 这样的写法,stdout 和 stderr 都直接送到 file 中, file 会被打开两次,这样 stdout 和 stderr 会互相覆盖,这样写相当使用了 FD1 和 FD2 两个同时去抢占 file 的管道</li> <li>command &gt;file 2&gt;&amp;1 这条命令就将 stdout 直接送向 file, stderr 继承了 FD1 管道后,再被送往 file,此时,file 只被打开了一次,也只使用了一个管道 FD1,它包括了 stdout 和 stderr 的内容</li></ul> <table><thead><tr><th>符号</th> <th>含义</th></tr></thead> <tbody><tr><td>&gt;</td> <td></td></tr> <tr><td>/dev/null</td> <td>代表空设备文件</td></tr> <tr><td>2</td> <td>表示 stderr 标准错误</td></tr> <tr><td>&amp;</td> <td>表示等同于的意思，2&gt;&amp;1，表示 2 的输出重定向等同于 1</td></tr> <tr><td>1</td> <td>1 表示 stdout 标准输出，系统默认值是 1，所以&quot;&gt;/dev/null&quot;等同于 &quot;1&gt;/dev/null&quot;</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token operator">&gt;</span> <span class="token comment">#!/bin/bash</span>
<span class="token operator">&gt;</span> <span class="token assign-left variable">USER_FILE</span><span class="token operator">=</span>users.txt
<span class="token operator">&gt;</span> <span class="token keyword">for</span> <span class="token for-or-select variable">USER</span> <span class="token keyword">in</span> user<span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">..</span><span class="token number">5</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
<span class="token operator">&gt;</span> <span class="token keyword">if</span> <span class="token operator">!</span> <span class="token function">id</span> <span class="token environment constant">$USER</span> <span class="token operator">&amp;&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>

    <span class="token assign-left variable">PASS</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token environment constant">$RANDOM</span> <span class="token operator">|</span> md5sum <span class="token operator">|</span> <span class="token function">cut</span> -c <span class="token number">1</span>-8<span class="token variable">)</span></span>
    <span class="token function">useradd</span> <span class="token environment constant">$USER</span>
    <span class="token builtin class-name">echo</span> <span class="token variable">$PASS</span> <span class="token operator">|</span> <span class="token function">passwd</span> --stdin <span class="token environment constant">$USER</span> <span class="token operator">&amp;&gt;</span> /dev/null
    <span class="token builtin class-name">echo</span> -e <span class="token string">&quot;<span class="token environment constant">$USER</span><span class="token entity" title="\t">\t</span><span class="token variable">$PASS</span>&quot;</span> <span class="token operator">&gt;&gt;</span> <span class="token variable">$USER_FILE</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token environment constant">$USER</span> user create successfully.&quot;</span>

<span class="token keyword">else</span>
echo_color red <span class="token string">&quot;<span class="token environment constant">$USER</span> already exists.&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_7-5-检查主机存活状态"><a href="#_7-5-检查主机存活状态" class="header-anchor">#</a> 7.5 检查主机存活状态</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token keyword">for</span> <span class="token for-or-select variable">IP</span> <span class="token keyword">in</span> <span class="token variable">$@</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
  <span class="token keyword">if</span> <span class="token function">ping</span> -c <span class="token number">1</span> <span class="token variable">$IP</span> <span class="token operator">&amp;&gt;</span>/dev/null<span class="token punctuation">;</span> <span class="token keyword">then</span>
     <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$IP</span> is ok.&quot;</span>
<span class="token keyword">else</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$IP</span> is wrong!&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">done</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="_7-6-系统监控"><a href="#_7-6-系统监控" class="header-anchor">#</a> 7.6 系统监控</h3> <h4 id="_7-6-1-系统命令"><a href="#_7-6-1-系统命令" class="header-anchor">#</a> 7.6.1 系统命令</h4> <h5 id="_7-6-1-1-vmstat"><a href="#_7-6-1-1-vmstat" class="header-anchor">#</a> 7.6.1.1 vmstat</h5> <ul><li>借助 vmstat 工具来分析 CPU 统计信息</li> <li>vmstat(Virtual Memory Statistics 虚拟内存统计) 命令用来显示 Linux 系统虚拟内存状态，也可以报告关于进程、内存、I/O 等系统整体运行状态</li> <li>vmstat [刷新延时 刷新次数]</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">vmstat</span> <span class="token number">1</span> <span class="token number">3</span>
procs -----------memory---------- ---swap-- -----io---- --system-- -----cpu-----
r b swpd <span class="token function">free</span> buff cache si so bi bo <span class="token keyword">in</span> cs us sy <span class="token function">id</span> wa st
<span class="token number">1</span> <span class="token number">0</span> <span class="token number">532</span> <span class="token number">329932</span> <span class="token number">99388</span> <span class="token number">459768</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">16</span> <span class="token number">81</span> <span class="token number">59</span> <span class="token number">50</span> <span class="token number">3</span> <span class="token number">1</span> <span class="token number">96</span> <span class="token number">0</span> <span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h5 id="_7-6-1-1-1-procs-进程信息字段"><a href="#_7-6-1-1-1-procs-进程信息字段" class="header-anchor">#</a> 7.6.1.1.1 (procs)进程信息字段</h5> <table><thead><tr><th>分类</th> <th>参数</th> <th>含义</th></tr></thead> <tbody><tr><td>procs</td> <td>r</td> <td>等待运行的进程数，数量越大，系统就越繁忙</td></tr> <tr><td>procs</td> <td>b</td> <td>不可被唤醒的进程数量，数量越大，系统越繁忙</td></tr></tbody></table> <h5 id="_7-6-1-1-2-memory-内存信息字段"><a href="#_7-6-1-1-2-memory-内存信息字段" class="header-anchor">#</a> 7.6.1.1.2 memory(内存信息字段)</h5> <table><thead><tr><th>分类</th> <th>参数</th> <th>含义</th></tr></thead> <tbody><tr><td>memory</td> <td>swpd</td> <td>使用的 Swap 空间的大小，单位 KB</td></tr> <tr><td>memory</td> <td>free</td> <td>空闲的内存容量，单位 KB</td></tr> <tr><td>memory</td> <td>buff</td> <td>缓冲的内存容量，单位 KB</td></tr> <tr><td>memory</td> <td>cache</td> <td>缓存的内存容量，单位 KB</td></tr></tbody></table> <h5 id="_7-6-1-1-3-swap-交换分区信息"><a href="#_7-6-1-1-3-swap-交换分区信息" class="header-anchor">#</a> 7.6.1.1.3 swap(交换分区信息)</h5> <p>如果说 si 和 so 数越大说明数据经常要在磁盘和内存之间数据交换，系统性能就会越差</p> <table><thead><tr><th>分类</th> <th>参数</th> <th>含义</th></tr></thead> <tbody><tr><td>swap</td> <td>si(in)</td> <td>从磁盘中交换到内存中的数据的数量，单位 KB</td></tr> <tr><td>swap</td> <td>so(out)</td> <td>从内存中交换到硬盘中的数据的数量，单位 KB</td></tr></tbody></table> <h5 id="_7-6-1-1-4-io-磁盘读写"><a href="#_7-6-1-1-4-io-磁盘读写" class="header-anchor">#</a> 7.6.1.1.4 io(磁盘读写)</h5> <p>bi 和 bo 数越大，说明磁盘的 I/O 越繁忙</p> <table><thead><tr><th>分类</th> <th>参数</th> <th>含义</th></tr></thead> <tbody><tr><td>io</td> <td>bi(in)</td> <td>从块设备读入数据的问题，单位是块</td></tr> <tr><td>io</td> <td>bo(out)</td> <td>写到块设备的数据的总量，单位是块</td></tr></tbody></table> <h5 id="_7-6-1-1-5-system-系统信息字段"><a href="#_7-6-1-1-5-system-系统信息字段" class="header-anchor">#</a> 7.6.1.1.5 system(系统信息字段)</h5> <p>in 和 cs 数越大，说明系统与接口设备的通信越繁忙</p> <table><thead><tr><th>分类</th> <th>参数</th> <th>含义</th></tr></thead> <tbody><tr><td>system</td> <td>in(interrupt)</td> <td>每秒被中断的进程次数</td></tr> <tr><td>system</td> <td>cs(switch)</td> <td>每秒钟进行的事件切换次数</td></tr></tbody></table> <h5 id="_7-6-1-1-6-cpu-cpu-信息字段"><a href="#_7-6-1-1-6-cpu-cpu-信息字段" class="header-anchor">#</a> 7.6.1.1.6 CPU(CPU 信息字段)</h5> <table><thead><tr><th>分类</th> <th>参数</th> <th>含义</th></tr></thead> <tbody><tr><td>CPU</td> <td>us(user)</td> <td>非内核进程消耗 CPU 运算时间的百分比</td></tr> <tr><td>CPU</td> <td>sy(system)</td> <td>内核进程消耗 CPU 运算时间的百分比</td></tr> <tr><td>CPU</td> <td>id(idea)</td> <td>空闲 CPU 的百分比</td></tr> <tr><td>CPU</td> <td>wa(wait)</td> <td>等待 I/O 所消耗的 CPU 百分比</td></tr> <tr><td>CPU</td> <td>st(steal)</td> <td>被虚拟机偷走的 CPU 百分比</td></tr></tbody></table> <h5 id="_7-6-1-2-free"><a href="#_7-6-1-2-free" class="header-anchor">#</a> 7.6.1.2 free</h5> <ul><li>查看内存使用状态</li> <li>free [-b|-k|-m|-g]
选项 |参数名称|参数含义| |:----|:----| |-b|以字节为单位| |-k|以 KB 字节为单位| |-m|以 MB 字节为单位| |-g|以 GB 字节为单位|</li></ul> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># free -m</span>
             total       used       <span class="token function">free</span>     shared    buffers     cached
Mem: <span class="token number">1006</span> <span class="token number">687</span> <span class="token number">319</span> <span class="token number">0</span> <span class="token number">98</span> <span class="token number">449</span>
-/+ buffers/cache: <span class="token number">139</span> <span class="token number">866</span>
Swap: <span class="token number">1999</span> <span class="token number">0</span> <span class="token number">1999</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h5 id="_7-6-1-2-1-第一行"><a href="#_7-6-1-2-1-第一行" class="header-anchor">#</a> 7.6.1.2.1 第一行</h5> <table><thead><tr><th>分类</th> <th>参数</th> <th>含义</th></tr></thead> <tbody><tr><td>total</td> <td>内存总数,total=used+free</td> <td></td></tr> <tr><td>used</td> <td>已经使用的内存数</td> <td></td></tr> <tr><td>free</td> <td>空闲的内存数</td> <td></td></tr> <tr><td>shared</td> <td>多个进程共享的内存数,0，废弃，永远为 0</td> <td></td></tr> <tr><td>buffers</td> <td>缓冲区内存数,buffer 用于作为写入磁盘的内容缓冲区</td> <td></td></tr> <tr><td>cached</td> <td>缓存内存数,用于从磁盘中读取的内容缓存</td> <td></td></tr></tbody></table> <h5 id="_7-6-1-2-2-第二行"><a href="#_7-6-1-2-2-第二行" class="header-anchor">#</a> 7.6.1.2.2 第二行</h5> <p>用于指示应用程序看到的内存情况，也就是应用程序获取内存大小</p> <table><thead><tr><th>参数</th> <th>算法</th> <th>含义</th></tr></thead> <tbody><tr><td>- buffers/cache</td> <td>第一行的 used-buffers-cached</td> <td>已经使用的要减去缓存和缓冲的内存量</td></tr> <tr><td>+ buffers/cache</td> <td>第一行的 free+buffers+cached</td> <td>空闲的要加上缓存和缓冲的内存量</td></tr></tbody></table> <h5 id="_7-6-1-2-3-第三行"><a href="#_7-6-1-2-3-第三行" class="header-anchor">#</a> 7.6.1.2.3 第三行</h5> <table><thead><tr><th>分类</th> <th>参数</th> <th>含义</th></tr></thead> <tbody><tr><td>total</td> <td>swap 总数，默认单位是 K</td> <td></td></tr> <tr><td>used</td> <td>已经使用的 swap 数，默认单位是 K</td> <td></td></tr> <tr><td>free</td> <td>空闲的 swap 数，默认单位是 K</td> <td></td></tr></tbody></table> <h5 id="_7-6-1-3-查询网络状态"><a href="#_7-6-1-3-查询网络状态" class="header-anchor">#</a> 7.6.1.3 查询网络状态</h5> <p>netstat 选项</p> <table><thead><tr><th>选项</th> <th>含义</th></tr></thead> <tbody><tr><td>-t</td> <td>列出 TCP 协议端口</td></tr> <tr><td>-u</td> <td>列出 UDP 协议端口</td></tr> <tr><td>-n</td> <td>不使用域名与服务名，而使用 IP 地址和端口号</td></tr> <tr><td>-l</td> <td>仅列出在监听状态网络服务</td></tr> <tr><td>-a</td> <td>列出所有的网络连接</td></tr></tbody></table> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">netstat</span> -tlun
<span class="token function">netstat</span> -an <span class="token operator">|</span> <span class="token function">more</span>
<span class="token function">netstat</span> -unt <span class="token operator">|</span> <span class="token function">grep</span> ESTABLISHED
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_7-6-2-函数"><a href="#_7-6-2-函数" class="header-anchor">#</a> 7.6.2 函数</h3> <h5 id="_7-6-2-1-cpu"><a href="#_7-6-2-1-cpu" class="header-anchor">#</a> 7.6.2.1 cpu</h5> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token function-name function">cpu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token builtin class-name">local</span> user system idle cwait
<span class="token assign-left variable">user</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">vmstat</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'NR==3{print $13}'</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">system</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">vmstat</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'NR==3{print $14}'</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">idea</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">vmstat</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'NR==3{print $15}'</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">cwait</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">vmstat</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'NR==3{print $16}'</span><span class="token variable">)</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;user cpu: <span class="token variable">$user</span>%&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;system cpu: <span class="token variable">$system</span>%&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;idle cpu: <span class="token variable">$idea</span>%&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;wait: <span class="token variable">$cwait</span>%&quot;</span>
<span class="token punctuation">}</span>
cpu
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h5 id="_7-6-2-2-memory"><a href="#_7-6-2-2-memory" class="header-anchor">#</a> 7.6.2.2 memory</h5> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function-name function">memory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token builtin class-name">local</span> total used <span class="token function">free</span>
<span class="token assign-left variable">used</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">free</span> -m <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'NR==3{print $3}'</span><span class="token variable">)</span></span>
  <span class="token assign-left variable">free</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">free</span> -m <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'NR==3{print $4}'</span><span class="token variable">)</span></span>
  <span class="token assign-left variable">total</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$used<span class="token operator">+</span>$free<span class="token variable">))</span></span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;内存总计: <span class="token variable">${total}</span>M&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;内存使用: <span class="token variable">${used}</span>M&quot;</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;内存剩余: <span class="token variable">${free}</span>M&quot;</span>
<span class="token punctuation">}</span>
memory
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="_7-6-2-3-disk"><a href="#_7-6-2-3-disk" class="header-anchor">#</a> 7.6.2.3 disk</h5> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function-name function">disk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token builtin class-name">local</span> <span class="token function">mount</span> total used used_percent <span class="token function">free</span>
<span class="token assign-left variable">partitions</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">df</span> -h<span class="token operator">|</span><span class="token function">awk</span> <span class="token string">'BEGIN{OFS=&quot;=&quot;}/^\/dev/{print $6,$2,$3,$4,$5}'</span><span class="token variable">)</span></span>
  <span class="token builtin class-name">echo</span> <span class="token variable">$p</span>
  <span class="token keyword">for</span> <span class="token for-or-select variable">p</span> <span class="token keyword">in</span>  <span class="token variable">$partitions</span><span class="token punctuation">;</span> <span class="token keyword">do</span>
    <span class="token assign-left variable">mount</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $p <span class="token operator">|</span> <span class="token function">cut</span> -d<span class="token string">&quot;=&quot;</span> -f1<span class="token variable">)</span></span>
    <span class="token assign-left variable">total</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $p <span class="token operator">|</span> <span class="token function">cut</span> -d<span class="token string">&quot;=&quot;</span> -f2<span class="token variable">)</span></span>
    <span class="token assign-left variable">used</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $p <span class="token operator">|</span> <span class="token function">cut</span> -d<span class="token string">&quot;=&quot;</span> -f3<span class="token variable">)</span></span>
    <span class="token assign-left variable">free</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $p <span class="token operator">|</span> <span class="token function">cut</span> -d<span class="token string">&quot;=&quot;</span> -f4<span class="token variable">)</span></span>
    <span class="token assign-left variable">used_percent</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> $p <span class="token operator">|</span> <span class="token function">cut</span> -d<span class="token string">&quot;=&quot;</span> -f5<span class="token operator">|</span><span class="token function">cut</span> -d<span class="token string">&quot;%&quot;</span> -f1<span class="token variable">)</span></span>
    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$used_percent</span> -ge <span class="token number">5</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
      <span class="token builtin class-name">echo</span> <span class="token string">&quot;挂载点=<span class="token variable">$mount</span>,总大小=<span class="token variable">$total</span>,使用大小=<span class="token variable">$used</span>,空闲大小=<span class="token variable">$free</span>,使用百分比=<span class="token variable">$used_percent</span>%&quot;</span>
<span class="token keyword">fi</span>
<span class="token keyword">done</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="_7-7-监控网络流量"><a href="#_7-7-监控网络流量" class="header-anchor">#</a> 7.7 监控网络流量</h3> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function-name function">network</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token builtin class-name">local</span> old_in old_out new_in new_out
<span class="token assign-left variable">old_in</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ifconfig</span> ens33 <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'/RX/&amp;&amp;/bytes/{print $5}'</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">old_out</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ifconfig</span> ens33 <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'/TX/&amp;&amp;/bytes/{print $5}'</span><span class="token variable">)</span></span>
    <span class="token function">sleep</span> 1s
    <span class="token assign-left variable">new_in</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ifconfig</span> ens33 <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'/RX/&amp;&amp;/bytes/{print $5}'</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">new_out</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">ifconfig</span> ens33 <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'/TX/&amp;&amp;/bytes/{print $5}'</span><span class="token variable">)</span></span>
    <span class="token assign-left variable">in</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$new_in<span class="token operator">-</span>$old_in<span class="token variable">))</span></span>
<span class="token assign-left variable">out</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>$new_out<span class="token operator">-</span>$old_out<span class="token variable">))</span></span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$1</span> 入口流量=<span class="token variable">${in}</span>bytes/s 出口流量=<span class="token variable">${out}</span>bytes/s&quot;</span>
<span class="token punctuation">}</span>
network
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="_7-8-监控网站状态"><a href="#_7-8-监控网站状态" class="header-anchor">#</a> 7.8 监控网站状态</h3> <p>-w 可以获取一些变量的值</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">curl</span> -o /dev/null -s -w <span class="token string">&quot;%{http_code}&quot;</span> http://www.baidu.com

<span class="token keyword">function</span> <span class="token function-name function">check_url</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
<span class="token assign-left variable">HTTP_CODE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">curl</span> -o /dev/null -s -w <span class="token string">&quot;%{http_code}&quot;</span> $1<span class="token variable">)</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$HTTP_CODE</span> -ne <span class="token number">200</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$1</span> 不可达&quot;</span>
<span class="token keyword">else</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$1</span> 状态正常&quot;</span>
<span class="token keyword">fi</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_7-9-监控-nginx-状态"><a href="#_7-9-监控-nginx-状态" class="header-anchor">#</a> 7.9 监控 nginx 状态</h3> <h4 id="_7-9-1-本地安装-nginx"><a href="#_7-9-1-本地安装-nginx" class="header-anchor">#</a> 7.9.1 本地安装 nginx</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">rpm</span> -Uvh http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm
yum <span class="token function">install</span> -y nginx
systemctl start nginx.service
systemctl status nginx.service
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_7-9-2-监控脚本"><a href="#_7-9-2-监控脚本" class="header-anchor">#</a> 7.9.2 监控脚本</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/bash</span>
<span class="token builtin class-name">local</span> nginx
<span class="token assign-left variable">nginx</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">ps</span> -ef <span class="token operator">|</span><span class="token function">grep</span> nginx<span class="token operator">|</span><span class="token function">grep</span> -v <span class="token function">grep</span><span class="token operator">|</span><span class="token function">wc</span> -l<span class="token variable">`</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$nginx</span> -gt <span class="token number">2</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;your nginx is running&quot;</span>
<span class="token builtin class-name">exit</span> <span class="token number">0</span>
<span class="token keyword">else</span>
/bin/systemctl start nginx.service
<span class="token builtin class-name">exit</span> <span class="token number">1</span>
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_7-10-监控-mysql-状态"><a href="#_7-10-监控-mysql-状态" class="header-anchor">#</a> 7.10 监控 mysql 状态</h3> <h4 id="_7-10-1-本地安装-mysql"><a href="#_7-10-1-本地安装-mysql" class="header-anchor">#</a> 7.10.1 本地安装 mysql</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">wget</span> -i -c http://dev.mysql.com/get/mysql57-community-release-el7-10.noarch.rpm
yum -y <span class="token function">install</span> mysql57-community-release-el7-10.noarch.rpm
yum -y <span class="token function">install</span> mysql-community-server
systemctl start mysqld.service
systemctl status mysqld.service

mysql -uroot -p
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_7-10-2-默认密码和忘记密码"><a href="#_7-10-2-默认密码和忘记密码" class="header-anchor">#</a> 7.10.2 默认密码和忘记密码</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">cat</span> /var/log/mysqld.log <span class="token operator">|</span> <span class="token function">grep</span> temporary

<span class="token number">1</span>. 修改/etc/my.conf, 添加参数 skip-grant-tables
   systemctl restart mysqld.service
   mysql -uroot
   use mysql
   update user <span class="token builtin class-name">set</span> <span class="token assign-left variable">authentication_string</span><span class="token operator">=</span>PASSWORD<span class="token punctuation">(</span><span class="token string">'123456'</span><span class="token punctuation">)</span> where <span class="token assign-left variable">User</span><span class="token operator">=</span><span class="token string">'root'</span><span class="token punctuation">;</span>
   alter user <span class="token string">'root'</span>@<span class="token string">'localhost'</span> identified by <span class="token string">'Zfpx2019@qq.com'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h5 id="_7-10-3-监控脚本"><a href="#_7-10-3-监控脚本" class="header-anchor">#</a> 7.10.3 监控脚本</h5> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token shebang important">#!/bin/sh</span>
<span class="token assign-left variable">PortNum</span><span class="token operator">=</span><span class="token variable"><span class="token variable">`</span><span class="token function">netstat</span> -lnt<span class="token operator">|</span><span class="token function">grep</span> <span class="token number">3306</span><span class="token operator">|</span><span class="token function">wc</span> -l<span class="token variable">`</span></span>
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$PortNum</span> -eq <span class="token number">1</span> <span class="token punctuation">]</span>
<span class="token keyword">then</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;mysqld is running.&quot;</span>
<span class="token keyword">else</span>
<span class="token builtin class-name">echo</span> <span class="token string">&quot;mysqld is stoped.&quot;</span>
<span class="token keyword">fi</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_7-11-mysql-备份脚本"><a href="#_7-11-mysql-备份脚本" class="header-anchor">#</a> 7.11 mysql 备份脚本</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code>
<span class="token comment">#!/bin/bash</span>
<span class="token assign-left variable">DATE</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%F_%H-%M-%S<span class="token variable">)</span></span>
<span class="token assign-left variable">HOST</span><span class="token operator">=</span><span class="token number">127.0</span>.0.1
<span class="token assign-left variable">DB</span><span class="token operator">=</span>test
<span class="token assign-left variable"><span class="token environment constant">USER</span></span><span class="token operator">=</span>root
<span class="token assign-left variable">PASS</span><span class="token operator">=</span>Zfpx2019@qq.com
<span class="token assign-left variable">MAIL</span><span class="token operator">=</span><span class="token string">&quot;83687401@qq.com&quot;</span>
<span class="token assign-left variable">BACKUP_DIR</span><span class="token operator">=</span>/data/db_backup
<span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> -d <span class="token string">&quot;<span class="token variable">$BACKUP</span>*DIR&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">then</span>
<span class="token function">mkdir</span> -p <span class="token variable">$BACKUP_DIR</span>
<span class="token keyword">fi</span>
<span class="token assign-left variable">SQL_FILE</span><span class="token operator">=</span><span class="token variable">${DB}</span><span class="token punctuation">\</span>_FULL*<span class="token variable">$DATE</span>.sql
<span class="token assign-left variable">BAK_FILE</span><span class="token operator">=</span><span class="token variable">${DB}</span>_FULL_<span class="token variable">$DATE</span>.zip
<span class="token builtin class-name">cd</span> <span class="token variable">$BACKUP_DIR</span>
<span class="token keyword">if</span> mysqldump -h<span class="token variable">$HOST</span> -u<span class="token environment constant">$USER</span> -p<span class="token variable">$PASS</span> -B <span class="token variable">$DB</span> <span class="token operator">&gt;</span> <span class="token variable">$SQL_FILE</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
  <span class="token function">zip</span> <span class="token variable">$BAK_FILE</span> <span class="token variable">$SQL_FILE</span> <span class="token operator">&amp;&amp;</span> <span class="token function">rm</span> -rf <span class="token variable">$SQL_FILE</span>
  <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> -s <span class="token variable">$BAK_FILE</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>
    <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$DATE</span> 备份失败&quot;</span> <span class="token operator">|</span> mail -s <span class="token string">&quot;备份失败&quot;</span> <span class="token variable">$MAIL</span>
  <span class="token keyword">fi</span>
<span class="token keyword">else</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;<span class="token variable">$DATE</span> 备份失败&quot;</span> <span class="token operator">|</span> mail -s <span class="token string">&quot;备份失败&quot;</span> <span class="token variable">$MAIL</span>
<span class="token keyword">fi</span>
<span class="token function">find</span> <span class="token variable">$BACKUP_DIR</span> -name <span class="token string">'\*.zip'</span> -ctime +14 -exec <span class="token function">rm</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token punctuation">\</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="_8-附录"><a href="#_8-附录" class="header-anchor">#</a> 8. 附录</h2> <h3 id="_8-1-linux-特殊文件"><a href="#_8-1-linux-特殊文件" class="header-anchor">#</a> 8.1. Linux 特殊文件</h3> <h4 id="_8-1-1-块设备"><a href="#_8-1-1-块设备" class="header-anchor">#</a> 8.1.1 块设备</h4> <p>块设备：系统能够随机无序访问固定大小的数据片的设备，这些数据片称为块。块设备是以固定大小长度来传送资料的，它使用缓冲区暂存数据，时机成熟后从缓存中一次性写入到设备或者从设备中一次性放到缓存区。常见的块设备有硬盘、CD-ROM 驱动器、Flash 闪存等等，它们也是通过文件形式存在于 Linux 中的。Linux 以 b(block)表示块设备</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># ll /dev/sr0</span>
brw-rw----. /dev/sr0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_8-1-2-字符设备"><a href="#_8-1-2-字符设备" class="header-anchor">#</a> 8.1.2 字符设备</h4> <p>字符设备：按照字符流方式被有序访问，以不定长度的字符传送资料，不存在缓冲区，所以对这种设备的读写都是实时的，比如键盘等等。Linux 以 c(char)表示字符设备</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token comment"># ll /dev/input/mouse0</span>
crw-r-----. /dev/input/mouse0
<span class="token comment"># ll /dev/input/event0</span>
crw-r-----. /dev/input/event0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="_8-1-3-管道文件"><a href="#_8-1-3-管道文件" class="header-anchor">#</a> 8.1.3 管道文件</h4> <p>管道文件是 linux 下的一种特殊缓存文件,所谓缓存就是只会存在于进程执行的时候，进程关闭管道文件也关闭了,管道文件要在读写的时候，先阻塞在写操作的 open 函数，当有读操作进来的时候，通信链路建立，写操作开始往管道里写东西，写完成之后，在读操作会把东西读出来，最后两个进程都正常结束退出,Linux 以 p(pipe)表示管道设备</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token function">find</span> / -type p
ll /var/run/autofs.fifo-misc
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="_8-1-4-套接字"><a href="#_8-1-4-套接字" class="header-anchor">#</a> 8.1.4 套接字</h4> <p>套接字 Socket 看做是不同主机之间的进程进行双向通信的端点，简单的说就是通信的两方的一种约定，用套接字中的相关函数来完成通信过程。套接字 Socket 是连接应用程序和网络驱动程序的桥梁，套接字 Socket 在应用程序中创建，通过绑定与网络驱动建立关系。此后，应用程序送给套接字 Socket 的数据，由套接字 Socket 交给网络驱动程序向网络上发送出去。计算机从网络上收到与该套接字 Socket 绑定 IP 地址和端口号相关的数据后，由网络驱动程序交给 Socket，应用程序便可从该 Socket 中提取接收到的数据，网络应用程序就是这样通过 Socket 进行数据的发送与接收的。Linux 以 S(Socket)表示套接字设备</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>root@localhost input<span class="token punctuation">]</span><span class="token comment"># ll /tmp/mysql.sock</span>
srwxrwxrwx. <span class="token number">1</span> mysql mysql <span class="token number">0</span> <span class="token number">4</span> 月 <span class="token number">6</span> <span class="token number">12</span>:18 /tmp/mysql.sock
<span class="token punctuation">[</span>root@localhost input<span class="token punctuation">]</span><span class="token comment"># ll /var/run/cups/cups.sock</span>
srwxrwxrwx. <span class="token number">1</span> root root <span class="token number">0</span> <span class="token number">4</span> 月 <span class="token number">6</span> <span class="token number">17</span>:51 /var/run/cups/cups.sock
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/zhoubichuan/web-devops/edit/master/src/base/linux/8.project.md" target="_blank" rel="noopener noreferrer">在github上编辑此页</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2022/8/13 16:04:39</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/web-devops/base/linux/7.module.html" class="prev">
        六.权限
      </a></span> <span class="next"><a href="/web-devops/base/linux/9.utils.html">
        八.软件包管理
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/web-devops/assets/js/app.fb86f629.js" defer></script><script src="/web-devops/assets/js/2.164ecb15.js" defer></script><script src="/web-devops/assets/js/58.8e62c021.js" defer></script><script src="/web-devops/assets/js/3.c618d7cd.js" defer></script>
  </body>
</html>
